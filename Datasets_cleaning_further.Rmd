---
title: "Data cleaning_NELDA"
author: "Domenic Hög"
date: "2024-06-20"
output: html_document
---

```{r}
library(haven)
library(dplyr)
library(tidyverse)
library(stringr)
library(readxl)
```

# 1. NELDA
```{r}
NELDA_broad <- read_excel("NELDA.xls")
```


### Deleting special characters 
Deleted special characters are - / and '. Besides, I have decoded N/A in the df to NA so that they are recognised as missing values. 
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ na_if(., "N/A")))

NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ str_replace_all(., "/", " ")))

NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ str_replace_all(., "'", "")))

NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ str_replace_all(., "�", "")))

```


### Checking for missing values and included countries 
```{r}
prop.table(table(NELDA_broad$nelda30, useNA = "ifany"))
prop.table(table(NELDA_broad$nelda30))
table(NELDA_broad$nelda45, useNA = "ifany")
prop.table(table(NELDA_broad$nelda45, useNA = "ifany"))
prop.table(table(NELDA_broad$nelda45))
table(NELDA_broad$nelda48, useNA = "ifany")
prop.table(table(NELDA_broad$nelda48, useNA = "ifany"))
prop.table(table(NELDA_broad$nelda48))
length(unique(NELDA_broad$stateid))
max(NELDA_broad$year)
```

## Changing yes/no structure to 0/1
in the entire nelda dataset, replacing yes with 1 and no with 0. 
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ str_replace_all(., "yes", "1"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "no", "0")))
```

## Creating variable country_code 
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(country_isocode = countrycode(stateid, origin = "gwc", destination = "iso3c", 
                               custom_match = c("AAB" = "ATG", "ABK" = "ABK", "AND" = "AND", "CZE" = "CZE", 
                                                "DMA" = "DMA", "GDR" = "DDR", "DRV" = "VNM", "FSM" = "FSM", 
                                                "GRN" = "GRD", "KBI" = "KIR", "KOS" = "KOS", "LIE" = "LIE",
                                                "MNC" = "MCO", "MSI" = "MHL", "NAU" = "NRU", "PAL" = "PLW", 
                                                "SEY" = "SYC", "SKN" = "KNA", "SLU" = "LCA", "SNM" = "SMR", 
                                                "SOT" = "SOT", "STP" = "STP", "SVG" = "VCT", "TON" = "TON",
                                                "TUV" = "TUV", "VAN" = "VUT", "WSM" = "WSM", "YEM" = "YEM",
                                                "YEM" = "YEM", "YPR" = "YPR", "BFO" = "BFA", "RVN" = "RVN")))

```


## Creating successor variable
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(successor = case_when(
    country_isocode == "RUS"  & year < 1990 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    country_isocode == "SRB" & year < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    country_isocode == "SRB" & year == 1991 ~ "BIH,MNE, SRB", 
    country_isocode == "SRB" & year <= 2005 & year > 1992 ~ "MNE, SRB",
    country_isocode == "YPR" ~ "YEM",
    country_isocode == "ZAF" & year <= 1980 ~ "ZAF, ZBW, NAM",
    country_isocode == "ZAF" & year >= 1981 & year <= 1989 ~ "ZAF, NAM",
    country_isocode == "SDN" & year <= 2011 ~ "SDN, SSD", 
    country_isocode == "ETH" & year <= 1992 ~ "ETH, ERI", 
    country_isocode == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    country_isocode == "CZE" & year <= 1992 ~ "CZE, SVK",
    country_isocode == "RVN" & year <= 1975 ~ "VNM",
    country_isocode == "DDR" & year <= 1989 ~ "DEU",
    TRUE ~ country_isocode
    ))
```


## Creating varible associated_state for cases of South Ossetia and Abkazhia 
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(associated_state = case_when(
    country_isocode == "ABK" ~ "GEO",
    country_isocode == "SOT" ~ "GEO",
    country_isocode == "RUS"  & year <= 1990 ~ "SUN", 
    country_isocode == "SRB"  & year <= 1991 ~ "YUG",
    TRUE ~ country_isocode
  ))
```

## changing unclear to NA
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(across(where(is.character), ~ na_if(., "unclear")))
```



## Date structure from variable mmddd to 2 seperate colums month and day
Deleting variable mmdd afterwards
- if nchar == 4, then split after the first 2 digits
- if nchar == 3, then split after the first digit
- if nchar == 2, then split after the first digit
```{r}

NELDA_broad <- NELDA_broad %>%
  mutate(month = 
           case_when(
             nchar(mmdd) == 4 ~ substr(mmdd, 1, 2),
             nchar(mmdd) == 3 ~ substr(mmdd, 1, 1),
             nchar(mmdd) == 2 ~ substr(mmdd, 1, 1)
           )) %>%
  mutate(day =
           case_when(
             nchar(mmdd) == 4 ~ substr(mmdd, 3, 4),
             nchar(mmdd) == 3 ~ substr(mmdd, 2, 3),
             nchar(mmdd) == 2 ~ substr(mmdd, 2, 2)
           )) %>%
  select(-mmdd)
    
```

## Event variable
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(event = make_date(year, month, 1)) %>%
  mutate(event = format(event, "%m-%Y"))

NELDA_broad <- NELDA_broad %>%
  mutate(event_day = make_date(year, month, day)) %>%
  mutate(event_day = format(event_day, "%d-%m-%Y"))
```


## Changing election type to numeric 
```{r}
NELDA_broad <- NELDA_broad %>%
  mutate(types = case_when(
    types == "Executive" ~ 1,
    types == "Legislative Parliamentary" ~ 2, 
    types == "Constituent Assembly" ~ 3,
    TRUE ~ NA
  ))

```

## Subset for relevant variables
Keeping only the relevant variables for the analysis: 
- nelda30, nelda48, nelda49, nelda29
- nelda3, nelda31
- country_isocode, associated_state, year, month, day, event
- successor, notes, types

```{r}
NELDA_final <- NELDA_broad %>%
  select(event, event_day, year, nelda30, nelda48, nelda49, nelda29, nelda3, nelda31, country_isocode, successor, associated_state,  notes, types)
```

```{r}
write.csv(NELDA_final, "NELDA_cleaned.csv")

```


# 2. Vdem civil liberty index
```{r}
Vdem <- read.csv("V-Dem-CD-v14.csv")
```


## Subsetting post 1945 data
```{r}
Vdem_subset <- subset(Vdem, Vdem$year >= 1945)
length(unique(Vdem_subset$country_text_id))
table(Vdem_subset$country_name)
table(Vdem_subset$country_text_id)
rm(Vdem)
```
One could group the data by year. 

## Checking for missing values
Checking for NAs in relevant variables per country
```{r}
Vdem_grouped <- Vdem_subset %>%
  group_by(country_text_id) %>%
  summarise(
    missing_regcorr = sum(is.na(v2xnp_regcorr)),
    actual_regcorr = sum(!is.na(v2xnp_regcorr)),
    missing_clphy = sum(is.na(v2x_clphy)),
    actual_clphy = sum(!is.na(v2x_clphy)),
    missing_csreprss = sum(is.na(v2csreprss)),
    actual_csreprss = sum(!is.na(v2csreprss)),
    missing_rlgrep = sum(is.na(v2csrlgrep)),
    actual_rlgrep = sum(!is.na(v2csrlgrep))
  ) %>%
  mutate(
    percent_regcorr = (actual_regcorr / (actual_regcorr + missing_regcorr)) * 100,
    percent_clphy = (actual_clphy / (actual_clphy + missing_clphy)) * 100,
    percent_csreprss = (actual_csreprss / (actual_csreprss + missing_csreprss)) * 100,
    percent_rlgrep = (actual_rlgrep / (actual_rlgrep + missing_rlgrep)) * 100
  )

print(Vdem_grouped)
```

## Countrycode to iso3
```{r}
Vdem_subset <- Vdem_subset %>%
  mutate(country_isocode = countrycode(country_name, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Zanzibar" = "ZZB", "Kosovo" = "KOS", "Republic of Vietnam" = "RVN", "Somaliland" = "SML", "South Yemen" = "YPR", "German Democratic Republic" = "DDR")))
```

## Creating successor variable
```{r}
Vdem_subset <- Vdem_subset %>%
  mutate(successor = case_when(
    country_isocode == "RUS"  & year < 1991 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    country_isocode == "SRB" & year < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    country_isocode == "SRB" & year == 1991 ~ "BIH, MNE, SRB", 
    country_isocode == "SRB" & year <= 2005 & year > 1992 ~ "MNE, SRB",
    country_isocode == "YPR" ~ "YEM",
    country_isocode == "ZAF" & year <= 1980 ~ "ZAF, ZBW, NAM",
    country_isocode == "ZAF" & year >= 1981 & year <= 1989 ~ "ZAF, NAM",
    country_isocode == "SDN" & year <= 2011 ~ "SDN, SSD", 
    country_isocode == "ETH" & year <= 1992 ~ "ETH, ERI", 
    country_isocode == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    country_isocode == "CZE" & year <= 1992 ~ "CZE, SVK",
    country_isocode == "RVN" & year <= 1975 ~ "VNM",
    country_isocode == "DDR" & year <= 1989 ~ "DEU",
    TRUE ~ country_isocode
    ))
```

## Creating variable associated_state
```{r}
Vdem_subset <- Vdem_subset %>%
  mutate(associated_state = case_when(
    country_isocode == "ZBB" & year >= 1963 ~ "TZA",
    country_isocode == "SML" ~ "SOM",
    country_isocode == "HKG" & year >= 1997 ~ "CHN",
    country_isocode == "SRB" & year <= 2003 ~ "YUG",
    TRUE ~ country_isocode
  ))
```




## Creating subset with only relevant variables
List of relevant variables: 
• regime corruption (v2xnp_regcorr) & pol. corruption index (v2x_corr)
• physical violence index (vsx_clphy) [v2clkill & v2cltort]
• CSO repression (v2csreprss) & religious organisation repression (v2clrlgrep) 
• country_isocode,  associated_state,
• historical_date (yyyy-mm-dd), year, 
• v2x_polyarchy  

```{r}
Vdem_subset <- Vdem_subset %>%
  select(country_isocode, associated_state, year, v2xnp_regcorr, v2x_corr, v2x_clphy, v2clkill, v2cltort, v2csreprss, v2csrlgrep, v2x_polyarchy, successor, historical_date  )
```


## Creating monthly coverage
Duplicating rows for monthly coverage. Values are taken for a month until a new entry has been made (eg. values of 1945-01-01 are chosen until 1945-02-0).
```{r}
library(zoo)

Vdem_subset$historical_date <- as.Date(Vdem_subset$historical_date)

Vdem_subset <- Vdem_subset %>%
  filter(!is.na(historical_date))


Vdem_months <- Vdem_subset %>%
  group_by(country_isocode) %>%
  summarize(start_date = min(historical_date), 
            end_date = max(historical_date), 
            .groups = "drop") %>%
  rowwise() %>%
  do(data.frame(country_isocode = .$country_isocode,
                 month = seq.Date(.$start_date, .$end_date, by = "month"))) %>%
  ungroup()

Vdem_coverage <- left_join(Vdem_months, 
                           Vdem_subset, 
                           by = c("country_isocode" = "country_isocode", 
                                  "month" = "historical_date"))

Vdem_coverage <- Vdem_coverage %>%
  arrange(country_isocode, month) %>% 
  group_by(country_isocode) %>%        
  mutate(across(matches("^(v2x|v2cl|v2cs|associated|year|successor)"), 
                 ~ zoo::na.locf(., na.rm = FALSE), 
                 .names = "{col}")) %>%  
  ungroup()


```

```{r}
Vdem_final <- Vdem_coverage %>%
  rename(historical_date = month) 

Vdem_final <- Vdem_final %>%
  mutate(year = year(historical_date),
    month = month(historical_date)  
  ) %>%
  mutate(event = make_date(year, month, 1)) %>%  
  mutate(event = format(event, "%m-%Y")) %>%
  select(-c(month))

  
```

```{r}
Vdem_final <- Vdem_final %>%
  select(-c(historical_date))

Vdem_final <- Vdem_final %>%
  select(c(event, country_isocode, associated_state, successor, year, v2xnp_regcorr, v2x_corr, v2x_clphy, v2clkill, v2cltort, v2csreprss, v2csrlgrep, v2x_polyarchy))
```

```{r}
write.csv(Vdem_final, "Vdem_cleaned.csv")
```


# 3. GTD Dataset
```{r}
GTD <- read_excel("GTB_1970-2022.xlsx")
```


## Deleting special characters
```{r}
GTD <- GTD %>%
  mutate(across(where(is.character), ~ str_replace_all(., "/", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "'", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "&", "and"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\(", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\)", "")))
```
 The seperation of dates is not optimal but these date_approx variable propably not necessary to use anyways. 
 
### Check for NAs 
Checking NAs in relevant variables 

```{r}
percentage_na <- GTD %>%
  summarise(across(
    c(country, provstate, latitude, longitude, attacktype1, weaptype1, targtype1,
      gname, nperpcap, claimed, nkill, nkillus, nwound, propvalue, ndays),
    ~ mean(is.na(.)) * 100,
    .names = "percent_na_{col}"
  ))

percentage_actual <- GTD %>%
  summarise(across(
    c(country, provstate, latitude, longitude, attacktype1, weaptype1, targtype1,
      gname, nperpcap, claimed, nkill, nkillus, nwound, propvalue, ndays),
    ~ mean(!is.na(.)) * 100,
    .names = "percent_actual_{col}"))

print(percentage_na)
print(percentage_actual)
```


## Countrycode to iso3
```{r}
GTD <- GTD %>%
  mutate(country_isocode = countrycode(country_txt, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Serbia-Montenegro" = "SGC", "Czechoslovakia" = "CZE", "East Germany GDR" = "DDR", "International" = "NA", "Kosovo" = "KOS", "North Yemen" = "YEM", "South Yemen" = "YPR", "Yugoslavia" = "YUG"))) 
                                
```

Taiwan, Kosovo exist, same Vatican 
```{r}
table(GTD$country_isocode)
```
## Recoding wrong code
Greenland natlty unlikely in eventid 199107160006
natlty1 == SDN. if eventid = 200901190017 | 200901190017
```{r}
GTD <- GTD %>%
  mutate(country_isocode = ifelse(eventid == 199107160006, "GRC", country_isocode)) %>%
  mutate(country_isocode = ifelse(eventid == 200901190017 | eventid == 200901190018, "SDN", country_isocode))
```

## Excluding  Western Sahara
```{r}
GTD <- GTD %>%
  filter(country_isocode != "ESH")

```

## Successor variable
```{r}
GTD <- GTD %>%
  mutate(successor = case_when(
    country_isocode == "SUN"  & iyear < 1991 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    country_isocode == "YUG" & iyear < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    country_isocode == "YUG" & iyear == 1991 ~ "BIH, MNE, SRB", 
    country_isocode == "YUG" & iyear <= 2003 & iyear > 1992 ~ "MNE, SRB",
    country_isocode == "SGC" ~ "MNE, SRB",
    country_isocode == "YPR" ~ "YEM",
    country_isocode == "SDN" & iyear <= 2011 ~ "SDN, SSD", 
    country_isocode == "ETH" & iyear <= 1992 ~ "ETH, ERI", 
    country_isocode == "IDN" & iyear >= 1975 & iyear <= 2001 ~ "IDN, TLS",
    country_isocode == "CZE" & iyear <= 1992 ~ "CZE, SVK",
    country_isocode == "RVN" & iyear <= 1975 ~ "VNM",
    country_isocode == "DDR" & iyear <= 1989 ~ "DEU",
    TRUE ~ country_isocode
    ))

```

## associated state 
```{r}
GTD <- GTD %>%
 mutate(associated_state = case_when(
   country_txt == "Bermuda" ~ "GBR",
   country_txt == "French Guiana" ~ "FRA",
   country_txt == "Guadeloupe" ~ "FRA",
   country_txt == "Hong Kong"  & iyear >= 1997 ~ "CHN",
   country_txt == "Hong Kong" & iyear < 1997 ~ "GBR",
   country_txt == "Macau" & iyear >= 1999 ~ "CHN",
   country_txt == "Macau" & iyear < 1999 ~ "PRT",
   country_txt == "Virgin Islands U.S." ~ "USA",
   country_txt == "Northern Ireland" ~ "GBR",
   country_txt == "Puerto Rico" ~ "USA",
   country_txt == "Man, Isle of" ~ "GBR", 
   country_txt == "New Caledonie" ~ "FRA",
   country_txt == "Martinique" ~ "FRA",
   TRUE ~ country_isocode))
```


## Nationality of target
### Countrycodes
```{r}
GTD <- GTD %>%
  mutate(natlty1 = countrycode(natlty1_txt, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Serbia-Montenegro" = "SGC", "Czechoslovakia" = "CZE", "East Germany GDR" = "DDR", "International" = "NA", "Kosovo" = "KOS", "North Yemen" = "YEM", "South Yemen" = "YPR", "Yugoslavia" = "YUG", "Asian" = NA, "Commonwealth of Independent States" = NA, "Corsica" = "FRA", "Northern Ireland" = "GBR", "Sinhalese" = "LKA", "Saba Netherlands Antilles" = "NLD", "Multinational" = NA, "St. Martin" = NA))) 

GTD <- GTD %>%
  mutate(natlty2 = countrycode(natlty2_txt, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Serbia-Montenegro" = "SGC", "Czechoslovakia" = "CZE", "East Germany GDR" = "DDR", "International" = "NA", "Kosovo" = "KOS", "North Yemen" = "YEM", "South Yemen" = "YPR", "Yugoslavia" = "YUG", "Asian" = NA, "Commonwealth of Independent States" = NA, "Corsica" = "FRA", "Northern Ireland" = "GBR", "Sinhalese" = "LKA", "Saba Netherlands Antilles" = "NLD", "Multinational" = NA, "St. Martin" = NA, "453" = NA))) 
                                
```

### Associated states
First listing all unique values in natlty1_txt and natlty2_txt
```{r}
table(GTD$natlty1_txt)
```

- cases: Bermuda, French Guiana, Guadeloupe, Hong Kong, Macau, Man, Isle of, Marshall Islands, Martinique, New Caledonia, Northern Ireland,  Puerto Rico, Virgin Islands U.S.
```{r}
GTD  <- GTD %>% 
  mutate(natlty1_assoc = case_when(
    natlty1_txt == "Bermuda" ~ "GBR",
    natlty1_txt == "French Guiana" ~ "FRA",
    natlty1_txt == "Guadeloupe" ~ "FRA",
    natlty1_txt == "Hong Kong"  & iyear >= 1997 ~ "CHN",
    natlty1_txt == "Hong Kong" & iyear < 1997 ~ "GBR",
    natlty1_txt == "Macau" & iyear >= 1999 ~ "CHN",
    natlty1_txt == "Macau" & iyear < 1999 ~ "PRT",
    natlty1_txt == "Virgin Islands U.S." ~ "USA",
    natlty1_txt == "Northern Ireland" ~ "GBR",
    natlty1_txt == "Puerto Rico" ~ "USA",
    natlty1_txt == "Man, Isle of" ~ "GBR",
    natlty1_txt == "New Caledonie" ~ "FRA",
    natlty1_txt == "Martinique" ~ "FRA",
    TRUE ~ natlty1))
```

###successor
```{r}
GTD <- GTD %>%
  mutate(natlty1_succ = case_when(
    natlty1 == "SUN"  & iyear < 1991 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    natlty1 == "YUG" & iyear < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    natlty1 == "YUG" & iyear == 1991 ~ "BIH, MNE, SRB",
    natlty1 == "YUG" & iyear <= 2003 & iyear > 1992 ~ "MNE, SRB",
    natlty1 == "SGC" ~ "MNE, SRB",
    natlty1 == "YPR" ~ "YEM",
    natlty1 == "SDN" & iyear <= 2011 ~ "SDN, SSD",
    natlty1 == "ETH" & iyear <= 1992 ~ "ETH, ERI",
    natlty1 == "IDN" & iyear >= 1975 & iyear <= 2001 ~ "IDN, TLS",
    natlty1 == "CZE" & iyear <= 1992 ~ "CZE, SVK",
    natlty1 == "RVN" & iyear <= 1975 ~ "VNM",
    natlty1 == "DDR" & iyear <= 1989 ~ "DEU",
    TRUE ~ natlty1
  ))
```


### Same steps for natlty2  
```{r}
table(GTD$natlty2_txt)
```

### Countrycode_natltly2
```{r}
GTD <- GTD %>%
  mutate(natlty2 = countrycode(natlty2_txt, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Serbia-Montenegro" = "SGC", "Czechoslovakia" = "CZE", "East Germany GDR" = "DDR", "International" = "NA", "Kosovo" = "KOS", "North Yemen" = "YEM", "South Yemen" = "YPR", "Yugoslavia" = "YUG", "Asian" = NA, "Commonwealth of Independent States" = NA, "Corsica" = "FRA", "Northern Ireland" = "GBR", "Sinhalese" = "LKA", "Saba Netherlands Antilles" = "NLD", "Multinational" = NA, "St. Martin" = NA, "453" = NA)))

GTD  <- GTD %>%
  mutate(natlty2_assoc = case_when(
    natlty2_txt == "Bermuda" ~ "GBR",
    natlty2_txt == "French Guiana" ~ "FRA",
    natlty2_txt == "Guadeloupe" ~ "FRA",
    natlty2_txt == "Hong Kong"  & iyear >= 1997 ~ "CHN",
    natlty2_txt == "Hong Kong" & iyear < 1997 ~ "GBR",
    natlty2_txt == "Macau" & iyear >= 1999 ~ "CHN",
    natlty2_txt == "Macau" & iyear < 1999 ~ "PRT",
    natlty2_txt == "Virgin Islands U.S." ~ "USA",
    natlty2_txt == "Northern Ireland" ~ "GBR",
    natlty2_txt == "Puerto Rico" ~ "USA",
    natlty2_txt == "Man, Isle of" ~ "GBR",
    natlty2_txt == "New Caledonie" ~ "FRA",
    natlty2_txt == "Martinique" ~ "FRA", 
    TRUE ~ natlty2))

GTD <- GTD %>%
  mutate(natlty2_succ = case_when(
    natlty2 == "SUN"  & iyear < 1991 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    natlty2 == "YUG" & iyear < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    natlty2 == "YUG" & iyear == 1991 ~ "BIH, MNE, SRB",
    natlty2 == "YUG" & iyear <= 2003 & iyear > 1992 ~ "MNE, SRB",
    natlty2 == "SGC" ~ "MNE, SRB",
    natlty2 == "YPR" ~ "YEM",
    natlty2 == "SDN" & iyear <= 2011 ~ "SDN, SSD",
    natlty2 == "ETH" & iyear <= 1992 ~ "ETH, ERI",
    natlty2 == "IDN" & iyear >= 1975 & iyear <= 2001 ~ "IDN, TLS",
    natlty2 == "CZE" & iyear <= 1992 ~ "CZE, SVK",
    natlty2 == "RVN" & iyear <= 1975 ~ "VNM",
    natlty2 == "DDR" & iyear <= 1989 ~ "DEU",
    TRUE ~ natlty2
  ))
```

## Same for natlty3
```{r}
table(GTD$natlty3_txt)
```

```{r}
GTD <- GTD %>%
  mutate(natlty3 = countrycode(natlty3_txt, origin = "country.name", destination = "iso3c", 
                                       custom_match = c("Serbia-Montenegro" = "SGC", "Czechoslovakia" = "CZE", "East Germany GDR" = "DDR", "International" = "NA", "Kosovo" = "KOS", "North Yemen" = "YEM", "South Yemen" = "YPR", "Yugoslavia" = "YUG", "Asian" = NA, "Commonwealth of Independent States" = NA, "Corsica" = "FRA", "Northern Ireland" = "GBR", "Sinhalese" = "LKA", "Saba Netherlands Antilles" = "NLD", "Multinational" = NA, "St. Martin" = NA, "453" = NA)))

GTD  <- GTD %>%
  mutate(natlty3_assoc = case_when(
    natlty3_txt == "Bermuda" ~ "GBR",
    natlty3_txt == "French Guiana" ~ "FRA",
    natlty3_txt == "Guadeloupe" ~ "FRA",
    natlty3_txt == "Hong Kong"  & iyear >= 1997 ~ "CHN",
    natlty3_txt == "Hong Kong" & iyear < 1997 ~ "GBR",
    natlty3_txt == "Macau" & iyear >= 1999 ~ "CHN",
    natlty3_txt == "Macau" & iyear < 1999 ~ "PRT",
    natlty3_txt == "Virgin Islands U.S." ~ "USA",
    natlty3_txt == "Northern Ireland" ~ "GBR",
    natlty3_txt == "Puerto Rico" ~ "USA",
    natlty3_txt == "Man, Isle of" ~ "GBR",
    natlty3_txt == "New Caledonie" ~ "FRA",
    natlty3_txt == "Martinique" ~ "FRA",
    TRUE ~ natlty3))

GTD <- GTD %>%
  mutate(natlty3_succ = case_when(
    natlty3 == "SUN"  & iyear < 1991 ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    natlty3 == "YUG" & iyear < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    natlty3 == "YUG" & iyear == 1991 ~ "BIH, MNE, SRB",
    natlty3 == "YUG" & iyear <= 2003 & iyear > 1992 ~ "MNE, SRB",
    natlty3 == "SGC" ~ "MNE, SRB",
    natlty3 == "YPR" ~ "YEM",
    natlty3 == "SDN" & iyear <= 2011 ~ "SDN, SSD",
    natlty3 == "ETH" & iyear <= 1992 ~ "ETH, ERI",
    natlty3 == "IDN" & iyear >= 1975 & iyear <= 2001 ~ "IDN, TLS",
    natlty3 == "CZE" & iyear <= 1992 ~ "CZE, SVK",
    natlty3 == "RVN" & iyear <= 1975 ~ "VNM",
    natlty3 == "DDR" & iyear <= 1989 ~ "DEU",
    TRUE ~ natlty3
  ))

```

## Changing unknown and -99 to NA across all variables 
```{r}
GTD <- GTD %>%
  mutate(across(where(is.character), ~ na_if(., "-99"))) %>%
  mutate(across(where(is.character), ~ na_if(., "Unknown")))
```

## Recoding missing dates
If iyear | imonth| iday == 0 -> NA
```{r}
GTD <- GTD %>%
  mutate(imonth = ifelse(imonth == 0, NA, imonth))
GTD <- GTD %>%
  mutate(iday = ifelse(iday == 0, NA, iday))
  
```


## Creating event variable
```{r}
GTD <- GTD %>%
  mutate(event = make_date(iyear, imonth)) %>%
  mutate(event = format(event, "%m-%Y"))

GTD <- GTD %>%
  mutate(event = ifelse(is.na(imonth), 
                        as.character(iyear),  
                        format(make_date(iyear, imonth), "%m-%Y"))) 
GTD <- GTD %>%
  mutate(event_day = ifelse(is.na(iday), 
                        format(make_date(iyear, imonth), "%m-%Y"), 
                        format(make_date(iyear, imonth, iday), "%d-%m-%Y")))
 
```

## Creating GTD_final as subset with relevant variables
• iyear, iday, imonth, event 
• country_isocode, associated_state, successor
• attacktype1, success (0/1)
• weaptype1
• targetype1 (2,3) ,
• natlty1, natlty2, natlty3, natlty1_succ, natlty1_assoc, natlty2_succ, natlty2_assoc, natlty3_succ, natlty3_assoc
• gname, (gname2,3..)
• nkill, nkillus, nkillter, nwound(us), propvalue, ihostkid, nhostkid(us),   
• eventid

```{r}
GTD_final <- GTD %>%
  select(iyear, event, event_day, country_isocode, successor, associated_state, attacktype1, success, gname, weaptype1, targtype1, natlty1, natlty1_succ, natlty1_assoc, targtype2, natlty2, natlty2_succ, natlty2_assoc, gname2, targtype3, natlty3, natlty3_succ, natlty3_assoc, gname3, nkill, nkillus, nkillter, nwound, propvalue, nhostkid)

```


```{r}
write.csv(GTD_final, "GTD_cleaned.csv")
```


# 4. ACLED
```{r}
ACLED <- read.csv("ACLED_1997-2024.csv")
```

## Steps for data wrangling


```{r}
table(ACLED$sub_event_type)
table(ACLED$event_type)
table(ACLED$civilian_targeting, useNA = "ifany")
```

```{r}
ACLED[ACLED == ""] <- NA
percentage_na_acled <- ACLED %>%
  summarise(across(
    c(year, location, latitude, longitude, sub_event_type, actor1, actor2, interaction,
      fatalities, civilian_targeting, assoc_actor_1),
    ~ mean(is.na(.)) * 100,
    .names = "percent_na_acled_{col}"
  ))

percentage_actual_acled <- ACLED %>%
  summarise(across(
    c(year, location, latitude, longitude, sub_event_type, actor1, actor2, interaction,
      fatalities, civilian_targeting, assoc_actor_1),
    ~ mean(!is.na(.)) * 100,
    .names = "percent_actual_acled_{col}"))

print(percentage_na_acled)
print(percentage_actual_acled)
```
```{r}
## Subsetting for excessive force against protesters 

ACLED_sub <- subset(ACLED, ACLED$sub_event_type == "Excessive force against protesters")
```


## Changing blank to NA in civilian_targeting
```{r}
ACLED <- ACLED %>%
  mutate(civilian_targeting = ifelse(civilian_targeting == "", 0, 1))
ACLED_sub <- ACLED_sub %>%
  mutate(civilian_targeting = ifelse(civilian_targeting == "", 0, 1))
```


```{r}
ACLED_sub[ACLED_sub == ""] <- NA
percentage_na_acled_sub <- ACLED_sub %>%
  summarise(across(
    c(year, location, latitude, longitude, sub_event_type, actor1, actor2, interaction,
      fatalities, civilian_targeting, assoc_actor_1),
    ~ mean(is.na(.)) * 100,
    .names = "percent_na_acled_sub_{col}"
  ))

percentage_actual_acled_sub <- ACLED_sub %>%
  summarise(across(
    c(year, location, latitude, longitude, sub_event_type, actor1, actor2, interaction,
      fatalities, civilian_targeting, assoc_actor_1),
    ~ mean(!is.na(.)) * 100,
    .names = "percent_actual_acled_sub_{col}"))

print(percentage_na_acled_sub)
print(percentage_actual_acled_sub)
```

```{r}
table(ACLED$country)
length(unique(ACLED_sub$country))
length(unique(ACLED$country))
```

```{r}
ACLED_sub <- ACLED_sub %>%
  mutate(across(where(is.character), ~ str_replace_all(., "-", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "/", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "'", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "&", "and"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\(", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\)", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., ";", "and"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "Political violenceand Demonstrations", "Political violence and Demonstrations")))

ACLED <- ACLED %>%
  mutate(across(where(is.character), ~ str_replace_all(., "-", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "/", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "'", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "&", "and"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\(", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\)", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., ";", "and"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "Political violenceand Demonstrations", "Political violence and Demonstrations")))
```

```{r}
table(ACLED_sub$country)
```
## Change date from dd month (written) yyyy to yyyy-mm-dd




```{r}

ACLED <- ACLED %>%
  mutate(event_date = trimws(event_date), 
         event_date = dmy(event_date)) %>%
  mutate(event_date = format(event_date, "%d-%m-%Y"),  
         event = format(dmy(event_date), "%m-%Y"))  

ACLED_sub <- ACLED_sub %>%
  mutate(event_date = trimws(event_date),  
         event_date = dmy(event_date), 
         event = format(event_date, "%m-%Y"))  

```



## Recoding sub_event_type
Excessive force against protesters == 1; protest with intervention 
```{r}
table(ACLED$sub_event_type)
ACLED <- ACLED %>%
  mutate(sub_event_type = case_when( 
    sub_event_type == "Excessive force against protesters" ~ "1",
    sub_event_type == "Protest with intervention" ~ "0",
  TRUE ~ sub_event_type))
```

```{r}
table(ACLED_sub$country)
```

## Creating iso3c countrycode
```{r}
ACLED_sub <- ACLED_sub %>%
 mutate(country_isocode = countrycode(iso, origin = "iso3n", destination = "iso3c", 
                                      custom_match = c("0" = "KOS")))
ACLED <- ACLED %>%
  mutate(country_isocode = countrycode(iso, origin = "iso3n", destination = "iso3c", 
                                      custom_match = c("0" = "KOS")))

```


## Successor variable 
```{r}
ACLED_sub <- ACLED_sub %>%
  mutate(successor = case_when(
    country_isocode == "SDN" & year <= 2011 ~ "SDN, SSD", 
    TRUE ~ country_isocode
    ))

ACLED <- ACLED %>%
  mutate(successor = case_when(
    country_isocode == "SDN" & year <= 2011 ~ "SDN, SSD", 
    TRUE ~ country_isocode
    ))

```


##Splitting date variable
Splitting from yyyy-mm-dd to year, month, day
```{r}
ACLED_sub <- ACLED_sub %>%
  mutate(year = year(event_date),
         month = month(event_date),
         day = day(event_date))

ACLED <- ACLED %>%
  mutate(year = year(event_date),
         month = month(event_date),
         day = day(event_date))
```


## Creating subset for relevant variables
• year, day, year, month event
• sub_event_type, actor1 
• interaction, fatalities, civilian_targeting
• country_code, successor 
```{r}
ACLED_final <- ACLED %>%
  select(year, event_date, event, inter1, inter2,  sub_event_type, actor1, actor2, interaction, fatalities, civilian_targeting, country_isocode, successor)

ACLED_sub_final <- ACLED_sub %>%
  select(year, event_date, event, sub_event_type, inter1, inter2, actor1, actor2, interaction, fatalities, civilian_targeting, country_isocode, successor)
```

```{r}
ACLED_final <- ACLED_final %>%
  mutate(event_day = event_date)

ACLED_sub_final <- ACLED_sub_final %>%
  mutate(event_day = event_date)

ACLED_final <- ACLED_final %>%
  select(event_day, event,  sub_event_type, actor1, actor2, inter1, inter2, interaction, fatalities, civilian_targeting, country_isocode, successor)

ACLED_sub_final <- ACLED_sub_final %>%
  select(year, event_day, event, sub_event_type, actor1, actor2, inter1, inter2, interaction, fatalities, civilian_targeting, country_isocode, successor)

```


```{r}
write.csv(ACLED_final, "ACLED_cleaned.csv")
```



# 5. Althaus et al. Coup Data
```{r}
Coup_data <- read.csv("Coup data 2.1.3.csv")
```

### Checking for country base
```{r}
table(Coup_data$country)
length(unique(Coup_data$country))
```

```{r}
percentage_na_coup <- Coup_data %>%
  summarise(across(
    c(cowcode, country, year, month, day, event_type, military, dissident, 
      rebel, foreign, noharm, injured, killed),
    ~ mean(is.na(.)) * 100,
    .names = "percent_na_coup_{col}"
  ))

percentage_actual_coup <- Coup_data %>%
  summarise(across(
    c(cowcode, country, year, month, day, event_type, military, dissident, 
      rebel, foreign, noharm, injured, killed),
    ~ mean(!is.na(.)) * 100,
    .names = "percent_actual_coup_{col}"))

print(percentage_na_coup)
print(percentage_actual_coup)
```
## Creating country_isocode
```{r}
Coup_data <- Coup_data %>%
  mutate(country_isocode = countrycode(cowcode, origin = "cown", destination = "iso3c", 
                                       custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "340" =  "SRB", "365" = "SUN", "393" = "RUS", "678" = "YEM", "680" = "YPR", "817" ="DRV" )))

```  

```{r}
table(Coup_data$country)
```


## successor variable 
Yugoslavia not included in the dataset
```{r}
Coup_data <- Coup_data %>%
  mutate(successor = case_when(
    country_isocode == "SUN" ~ "AZE, BLR, EST, KAZ, KGZ, LTU, LVA, MDA, RUS, UZB, ARM, GEO, TJK, TKM, UKR",
    country_isocode == "YPR" ~ "YEM",
    country_isocode == "ZAF" & year >= 1981 & year <= 1989 ~ "ZAF, NAM",
    country_isocode == "SDN" & year <= 2011 ~ "SDN, SSD", 
    country_isocode == "ETH" & year <= 1992 ~ "ETH, ERI", 
    country_isocode == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    country_isocode == "CZE" & year <= 1992 ~ "CZE, SVK",
    country_isocode == "RVN" & year <= 1975 ~ "VNM",
    country_isocode == "DDR" & year <= 1989 ~ "DEU",
    TRUE ~ country_isocode
    ))
```


## Event_type
```{r}
Coup_data <- Coup_data %>%
  mutate(event_type = case_when(
    event_type == "coup" ~ "1",
    event_type == "attempted coup" ~ "2",
    event_type == "conspiracy" ~ "3",
    TRUE ~ event_type
  
  ))
```

## Event variable 
```{r}
Coup_data <- Coup_data %>%
  mutate(event = make_date(year, month, day)) %>%
  mutate(event = format(event, "%m-%Y")) 

Coup_data <- Coup_data %>%
  mutate(event_day = ifelse(is.na(day),
                              format(make_date(year, month), "%d-%m-%Y"), 
                              format(make_date(year, month, day), "%d-%m-%Y")))
```


## coup_final as subset with relevant variables
• cowcode, country, year, month, day, event
• event_type (see coup_add)
• groups: military, dissident, rebel, foreign
• noharm, injured, killed
• country_code, successor

```{r}
Coup_final <- Coup_data %>%
  select(event, event_day, year,country_isocode, successor,  event_type, military, dissident, rebel, foreign, noharm, injured, killed, harrest, fled, exile, counter, popular, resign, realized )

```

```{r}
write.csv(Coup_final, "Coup_cleaned.csv")

```


# 6. IDS 

```{r}
IDS <- read_excel("IDS_data complete.xlsx")

```


## Checking for country base
```{r}
length(unique(IDS$ISO3))
table(IDS$`Country/Territory of Seizure`)
```
### Checking for NAs in relevant variables
```{r}
percentage_na_ids <- IDS %>%
  summarise(across(
    c(`Seizure Date`, ISO3, City, `Drug/Substance`, `Quantity Seized`, `Measurement Unit`),
    ~ mean(is.na(.)) * 100,
    .names = "percent_na_ids_{col}"
  ))

percentage_actual_ids <- IDS %>%
  summarise(across(
    c(`Seizure Date`, ISO3, City, `Drug/Substance`, `Quantity Seized`, `Measurement Unit`),
    ~ mean(!is.na(.)) * 100,
    .names = "percent_actual_ids_{col}"))

print(percentage_na_ids)
print(percentage_actual_ids)
```
### Replacing special characters
```{r}
IDS <- IDS %>%
  mutate(across(where(is.character), ~ str_replace_all(., "/", " "))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "'", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\(", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "\\)", ""))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., ";", "and")))
  
```


## Changing Data not available to NA
```{r}
IDS <- IDS %>%
  mutate(`Physical Seizure Location` = na_if(`Physical Seizure Location`, "Data not available")) 
IDS <- IDS %>%
  mutate(`Trafficking Mode of Transportation` = na_if(`Trafficking Mode of Transportation`, "Data not available")) 

```

## associated state variable
```{r}
IDS <- IDS %>%
  mutate(associated_state = case_when(
    ISO3 == "PRI" ~ "USA",
    ISO3 == "MTQ" ~ "FRA",
    TRUE ~ ISO3
    ))
```

## Potentially deleting Palestine
```{r}
IDS <- IDS %>%
  filter(ISO3 != "PSE")
```

## Changing measurement unit
If measurement unit = g, then making it kg and dividing Quantity Seized by 1000
```{r}
IDS <- IDS %>%
  mutate(
    `Quantity Seized` = case_when(
      `Measurement Unit` == "g" ~ `Quantity Seized` / 1000, 
      TRUE ~ `Quantity Seized` 
    ),
    `Measurement Unit` = case_when(
      `Measurement Unit` == "g" ~ "kg", 
      TRUE ~ `Measurement Unit` 
    )
  )

```

## Creating event variable
```{r}
IDS <- IDS %>%
  mutate(
    `Seizure Date` = as.Date(`Seizure Date`),  
    event = format(`Seizure Date`, "%m-%Y")     
  )
```

```{r}
IDS <- IDS %>%
  mutate(event_day = format(as.Date(`Seizure Date`), "%d-%m-%Y"))
```



## Creating IDS_final as subset with relevant variables
• event, year, month, day
•ISO3, City, associated_state 
• Drug/Substance, Quantity Seized, Measurement Unit

```{r}
IDS_final <- IDS %>%
  select(event, event_day, ISO3, City, associated_state, `Drug/Substance`, `Quantity Seized`, `Measurement Unit`)
```

```{r}
write.csv(IDS_final, "IDS_cleaned.csv")

```


# 7. Eurepoc
## Loading and merging relevant datasets 
```{r}
eurepoc <- read_excel("eurepoc_data_2024-06-17T12_43.xlsx")
eurepoc_receiver <- read.csv("EuRepoC_Receiver_Dataset_1.2.csv")
eurepoc_atrri <- read.csv("EuRepoC_Attribution_Dataset_1.2.csv")
merged_eurepoc <- left_join(eurepoc_atrri, eurepoc_receiver, by = "incident_id")
```


## Selectig relevant variables and further merging 
Merging the subsetted global dataset with the combined receiver_attribution data set. 
```{r}
Eurepoc_sub <- eurepoc %>%
  select("start_date", "attribution_ID", "initiator_name", "initiator_country", "incident_type", "number_of_political_responses", "unweighted_cyber_intensity", "weighted_cyber_intensity", "target_multiplier", "impact_indicator", "legal_response_country", "functional_impact", "intelligence_impact", "political_impact_affected_entities", "political_impact_third_countries", "economic_impact", "impact_indicator_value", "legal_response_type")
Eurepoc_sub$attribution_ID <- as.integer(Eurepoc_sub$attribution_ID)
Eurepoc_final <- left_join(merged_eurepoc, Eurepoc_sub, by = c("attribution_id" = "attribution_ID"))
```

## selecting

```{r}
Eurepoc_final <- Eurepoc_final %>%
  select("incident_id", "id", "name", "country", "category", "start_date", "attribution_date", "initiator_name", "initiator_country", "incident_type", "number_of_political_responses", "unweighted_cyber_intensity", "weighted_cyber_intensity", "target_multiplier", "impact_indicator",  "legal_response_country", "functional_impact", "intelligence_impact", "political_impact_affected_entities", "political_impact_third_countries", "economic_impact","impact_indicator_value", "legal_response_type")
```


## changing unknown to NA
```{r}
Eurepoc_final <- Eurepoc_final %>%
  mutate(across(where(is.character), ~ na_if(., "Not available")))
```


```{r}

table(eurepoc_atrri$attribution_country, useNA = "ifany")
```

## Deleting cases with non-natio state as aggressor 
```{r}
Eurepoc_final <- subset(Eurepoc_final, Eurepoc_final$initiator_country != c("NA", "Unknown", "Asia (region)", "Central America (region)", "Eastern Europe", "Gulf countries (region)", "ISIS", "Mena Region (region)", "Middle East (region)", "North Africa (region)", "North America (region)", "South America (region)", "South Asia (region)", "South East Asia (region)", "Sub-Saharan Africa (region)", "Western Europe", "Western Europe (region)", "Western Europe (region)", "South America", "South Asia (region)"))
```

## Modifying country variable 
Deleting regions and changing to iso-code 3; changing unknown to NA
```{r}
table(sum(is.na(Eurepoc_final$start_date)))
table(Eurepoc_final$country)
Eurepoc_final <- Eurepoc_final %>%
  mutate(country = case_when(
    country %in% c("Africa", "Asia (region)", "Balkans (region)", 
                   "Central America (region)", "Central Asia (region)", 
                   "Eastern Asia (region)", "Eastern Europe", 
                   "Global (region)", "Holy See (Vatican City State)", 
                   "Interpol", "ISIS", "Mena Region (region)", 
                   "Middle East (region)", "NATO (institutions)", 
                   "NATO (region)", "Northeast Asia (region)", 
                   "North Africa (region)", "North America", 
                   "Organization for Security and Cooperation in Europe", 
                   "South America", "South Asia (region)", 
                   "South China Sea (region)", "Southeast Asia (region)", 
                   "UNICEF", "United Nations", 
                   "United Nations Economic and Social Council", 
                   "United Nations Environment Programme", "Europe region",
                   "United Nations Organization", "Western Europe") ~ NA,
    country %in% c("EU (institutions)", "EU (region)") ~ "EU",
    TRUE ~ country 
  ))

Eurepoc_final <- Eurepoc_final %>%
  mutate(country = countrycode(country, origin = "country.name", destination = "iso3c"))

Eurepoc_final <- Eurepoc_final %>%
  select(-c(name)) 
Eurepoc_final <- Eurepoc_final %>%
  mutate(across(where(is.character), ~ na_if(., "Unknown")))
```

## Splitting initiator_country into two variables and changing to iso3c
```{r}
Eurepoc_final <- Eurepoc_final %>%
  separate(initiator_country, 
           into = c("initiator_country_1", "initiator_country_2"), 
           sep = "; ", 
           fill = "right", 
           remove = TRUE)
Eurepoc_final <- Eurepoc_final %>%
  mutate(initiator_country_1 = case_when(
    initiator_country_1 %in% c("Asia (region)", "Central America (region)", "Eastern Europe", "Gulf Countries (region)", "ISIS", "Mena Region (region)", "Middle East (region)", "South America", "South Asia (region)") ~ NA,
    TRUE ~ initiator_country_1)) 

Eurepoc_final <- Eurepoc_final %>%
  mutate(initiator_country_1 = countrycode(initiator_country_1, origin = "country.name", destination = "iso3c"))

Eurepoc_final <- Eurepoc_final %>%
  mutate(initiator_country_2 = countrycode(initiator_country_2, origin = "country.name", destination = "iso3c"))

```

## Subsetting for cases with an initiator country
```{r}
Eurepoc_final_complete <- subset(Eurepoc_final, !is.na(initiator_country_1))
```


## Associated state variable
```{r}
table(Eurepoc_final_complete$country)
table(Eurepoc_final_complete$initiator_country_1)
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(country_assoc = case_when(
    country == "BMU" ~ "GBR",
    country == "NCL" ~ "FRA",
    country == "HGK" ~ "CHN",
    TRUE ~ country
  ))
```

## Changing to numeric: category
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(category = case_when(
    category == "Corporate Targets (corporate targets only coded if the respective company is not part of the critical infrastructure definition)" ~ 5,
    category == "Critical infrastructure" ~ 3,
    category == "Education" ~ 9,
    category == "End user(s) / specially protected groups" ~ 6,
    category == "International / supranational organization" ~ 2,
    category == "Media" ~ 7,
    category == "Other" ~ 10,
    category == "Science"~ 8,
    category == "Social groups" ~ 4,
    category == "State institutions / political system" ~ 1, 
    TRUE ~ NA
  ))
```

## Extracting year
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(
    year = year(`start_date`),
    month = month(`start_date`),
    day = day(`start_date`)
  )

```


## Creating event variables 
```{r}

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(
    event_attri = case_when(
      str_detect(attribution_date, "^\\d{4}$") ~ as.character(attribution_date), 
      str_detect(attribution_date, "^\\d{4}-(\\d{1})$") ~ 
        paste0(sub("-(\\d{1})$", "", attribution_date), sprintf("-%02d", as.integer(sub(".*-(\\d{1})$", "\\1", attribution_date)))), 
      str_detect(attribution_date, "^\\d{4}-(\\d{2})$") ~ 
        as.character(attribution_date), 
      str_detect(attribution_date, "^\\d{4}-(\\d{1})-(\\d{1})$") ~ 
        paste0(sub("-(\\d{1})-(\\d{1})$", "", attribution_date), sprintf("-%02d", as.integer(sub(".*-(\\d{1})-(\\d{1})$", "\\1", attribution_date)))),  
      str_detect(attribution_date, "^\\d{4}-(\\d{2})-(\\d{1})$") ~ 
        sub("-(\\d{2})-(\\d{1})$", "-\\1", attribution_date),  
      str_detect(attribution_date, "^\\d{4}-(\\d{1})-(\\d{2})$") ~ 
        paste0(sub("-(\\d{1})-(\\d{2})$", "", attribution_date), sprintf("-%02d", as.integer(sub(".*-(\\d{1})-(\\d{2})$", "\\1", attribution_date)))), 
      str_detect(attribution_date, "^\\d{4}-(\\d{2})-(\\d{2})$") ~ 
        sub("-(\\d{2})-(\\d{2})$", "-\\1", attribution_date), 

      TRUE ~ NA_character_  
    )
  )

```

changing event_attri from yyyy-mm to mm-yyyy
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(event_attri = str_replace(event_attri, "(\\d{4})-(\\d{2})", "\\2-\\1"))

```


## Recoding the incident type
  
1  Data theft 
2  Data theft & Doxing
3  Disruption 
4  Hijacking with misuse 
5  Hijacking without misuse 
6  Ransomware 
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  separate(incident_type, 
           into = c("incident_type_1", "incident_type_2", "incident_type_3"), 
           sep = "; ", 
           fill = "right", 
           extra = "drop")
table(Eurepoc_final_complete$incident_type_1)
table(Eurepoc_final_complete$incident_type_2)

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(incident_type_1 = case_when(
    incident_type_1 == "Data theft" ~ 1,
    incident_type_1 == "Data theft & Doxing" ~ 2,
    incident_type_1 == "Disruption" ~ 3,
    incident_type_1 == "Hijacking with misuse" ~ 4,
    incident_type_1 == "Hijacking" ~ 5,
    incident_type_1 == "Ransomware" ~ 6,
    incident_type_1 == "Not available" ~ NA, 
    TRUE ~ NA))

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(incident_type_2 = case_when(
    incident_type_2 == "Data theft" ~ 1,
    incident_type_2 == "Data theft & Doxing" ~ 2,
    incident_type_2 == "Disruption" ~ 3,
    incident_type_2 == "Hijacking with misuse" ~ 4,
    incident_type_2 == "Hijacking" ~ 5,
    incident_type_2 == "Ransomware" ~ 6,
    incident_type_2 == "Not available" ~ NA, 
    TRUE ~ NA))

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(incident_type_3 = case_when(
    incident_type_3 == "Data theft" ~ 1,
    incident_type_3 == "Data theft & Doxing" ~ 2,
    incident_type_3 == "Disruption" ~ 3,
    incident_type_3 == "Hijacking with misuse" ~ 4,
    incident_type_3 == "Hijacking" ~ 5,
    incident_type_3 == "Ransomware" ~ 6,
    incident_type_3 == "Not available" ~ NA, 
    TRUE ~ NA))

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(
    incident_type_1 = case_when(
      is.na(incident_type_1) & !is.na(incident_type_2) ~ incident_type_2, 
      TRUE ~ incident_type_1 
    ),
    incident_type_2 = case_when(
      is.na(incident_type_2) & !is.na(incident_type_1) ~ incident_type_1,  
      TRUE ~ incident_type_2))

```
## creating event variable based on start_date

```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(start_date = str_replace(start_date, "(\\d{4})-(\\d{2})-(\\d{2})", "\\3-\\2-\\1"))
```


```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(event = format(as.Date(start_date, format = "%d-%m-%Y"), "%m-%Y"))

Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(event_day = format(as.Date(start_date, format = "%d-%m-%Y"), "%d-%m-%Y"))
```


## Order of variables
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  select(c(event, event_day, event_attri,year, country, country_assoc,  category,  initiator_name, initiator_country_1, initiator_country_2, incident_type_1, incident_type_2, incident_type_3, unweighted_cyber_intensity, weighted_cyber_intensity, target_multiplier, impact_indicator, number_of_political_responses,  weighted_cyber_intensity, target_multiplier, impact_indicator,  legal_response_country, functional_impact,intelligence_impact, political_impact_affected_entities, political_impact_third_countries, economic_impact, impact_indicator_value, legal_response_type))

```

## Recode impact_indicator
```{r}
table(Eurepoc_final_complete$impact_indicator)
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(impact_indicator = case_when(
    impact_indicator == "Low" ~ 1,
    impact_indicator == "Medium" ~ 3,
    impact_indicator == "Minor" ~ 2,
  ))
```

## countrycode for legal_response_country
```{r}
table(Eurepoc_final_complete$legal_response_country)
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(legal_response_country = countrycode(legal_response_country, origin = "country.name", destination = "iso3c"))
```

```{r}
table(Eurepoc_final_complete$legal_response_type)
```

## Recoding legal_response_type
`
No justification under IL ~ 1
Other legal measures on national level (e.g. law enforcement investigations, arrest ~ 2
Peaceful means: Retorsion (International Law) ~ 3

```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>% 
  mutate(legal_response_type = case_when(
    legal_response_type == "No justification under IL" ~ 1,
    legal_response_type == "Other legal measures on national level (e.g. law enforcement investigations, arrest)" ~ 2,
    legal_response_type == "Peaceful means: Retorsion (International Law)" ~ 3,
    TRUE ~ NA
  ))

```

## Recoding target_multiplier and functional_impact
```{r}
table(Eurepoc_final_complete$target_multiplier)
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(target_multiplier = case_when(
    target_multiplier == "Moderate - high political importance" ~ 1, 
    target_multiplier == "Moderate - high political importance; Moderate - high political importance" ~ 1, 
    target_multiplier == "Very high political importance (e.g., critical infrastructure, military) - intensity multiplied by 1.5" ~ 2,
    TRUE ~ NA
  ))
```


```{r}
table(Eurepoc_final_complete$functional_impact)
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(functional_impact = case_when(
    functional_impact == "No system interference/disruption" ~ 1, 
    functional_impact == "Day (< 24h)" ~ 2, 
    functional_impact == "Days (< 7 days)" ~ 3, 
    functional_impact == "Weeks (< 4 weeks)" ~ 4,
    functional_impact == "Months" ~ 5,
    TRUE ~ NA
  ))
```
No system interference/disruption ~ 1 
Day (< 24h) ~ 2 
Days (< 7 days) ~ 3 
Weeks (< 4 weeks) ~ 4
Months  ~ 5

## table and recoding: intelligence_impact, political_impact_affected_entities, political_impact_third_countries, economic_impact

```{r}
table(Eurepoc_final_complete$intelligence_impact)

```

```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(intelligence_impact = case_when(
    intelligence_impact == "No data breach/exfiltration or data corruption (deletion/altering) and/or leaking of data" ~ 1, 
    intelligence_impact == "Minor data breach/exfiltration (no critical/sensitive information), but no data corruption (deletion/altering) or leaking of data" ~ 2, 
    intelligence_impact == "Data corruption (deletion/altering) but no leaking of data, no data breach/exfiltration OR major data breach / exfiltration, but no data corruption and/or leaking of data" ~ 3, 
    intelligence_impact == "Minor data breach/exfiltration (no critical/sensitive information), data corruption (deletion/altering) and/or leaking of data" ~ 4,
    intelligence_impact == "Major data breach/exfiltration, data corruption (deletion/altering) and/or leaking of data" ~ 5,
    TRUE ~ NA
  ))
```

```{r}
table(Eurepoc_final_complete$political_impact_affected_entities)
```
```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(political_impact_affected_entities = case_when(
    political_impact_affected_entities == "1-10" ~ 1, 
    political_impact_affected_entities == "11-50" ~ 2, 
    political_impact_affected_entities == "201-500" ~ 4, 
    political_impact_affected_entities == "501-10000" ~ 5,
    political_impact_affected_entities == "51-200" ~ 3,
    TRUE ~ NA
  ))
```


```{r}
table(Eurepoc_final_complete$political_impact_third_countries)
```
1 1 - 10 
2 11 - 20 
3 21 - 50 
4 51 - 100 
5 101 - 193 

```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(political_impact_third_countries = case_when(
    political_impact_third_countries == "1-10" ~ 1, 
    political_impact_third_countries == "11-20" ~ 2, 
    political_impact_third_countries == "21-50" ~ 3, 
    political_impact_third_countries == "51-100" ~ 4,
    political_impact_third_countries == "101-193" ~ 5,
    TRUE ~ NA
  ))

```

```{r}
table(Eurepoc_final_complete$economic_impact, useNA = "ifany")
```
1 None 
2 =< 10 Mio 
3 > 10 Mio – 100 Mio 
4  > 100 Mio – 1 Bn 
5  > 1 Bn 

```{r}
Eurepoc_final_complete <- Eurepoc_final_complete %>%
  mutate(economic_impact = case_when(
    economic_impact == "None" ~ 1, 
    economic_impact == "=< 10 Mio" ~ 2, 
    economic_impact == "> 10 Mio - 100 Mio" ~ 3, 
    economic_impact == "> 100 Mio - 1 Bn" ~ 4,
    economic_impact == "> 1 Bn" ~ 5,
    TRUE ~ NA
  ))

```


```{r}
write.csv(Eurepoc_final_complete, "Eurepoc_final_complete_1.2.csv")
```


```{r}
Data_eurepoc <- read_csv("Eurepoc_final_complete.csv", show_col_types = FALSE)
```


# 8. TIES 

## Loading and viewing data set
```{r}
TIES <- read_excel("TIESv4-1.xls")
```

## Changing from COW to iso3 
Including adaptions for West- and East Germany, Yugoslavia, Czechoslovakia, the Arab Republic o Yemen, the Peoples Republic of Yemen, and the European Union. Until 1992 EEC, from 1993 on EU. 


```{r}
TIES <- TIES %>%
  mutate(sender1 = case_when(
    sender1 == 1000 & startyear <= 1992 ~ 1001, 
    sender1 == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ sender1)) %>%
  mutate(sender2 = case_when(
    sender2 == 1000 & startyear <= 1992 ~ 1001, 
    sender2 == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ sender2)) %>%
  mutate(sender3 = case_when(
    sender3 == 1000 & startyear <= 1992 ~ 1001, 
    sender3 == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ sender3)) %>%
  mutate(sender4 = case_when(
    sender4 == 1000 & startyear <= 1992 ~ 1001, 
    sender4 == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ sender4)) %>%
  mutate(sender5 = case_when(
    sender5 == 1000 & startyear <= 1992 ~ 1001, 
    sender5 == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ sender5)) %>%
  mutate(primarysender = case_when(
    primarysender == 1000 & startyear <= 1992 ~ 1001, 
    primarysender == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ primarysender)) %>%
  mutate(targetstate = case_when(
    targetstate == 1000 & startyear <= 1992 ~ 1001, 
    targetstate == 1000 & startyear > 1992 ~ 1000,
    TRUE ~ targetstate))
```


```{r}
 TIES <- TIES %>%
  mutate(Sender1 = countrycode(sender1, origin = "cown", destination = "iso3c", 
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1001" = "EEC", "1000" = "EU"))) %>%
  mutate(Sender2 = countrycode(sender2, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU", "1001" = "EEC"))) %>% 
  mutate(Sender3 = countrycode(sender3, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU", "1001" = "EEC"))) %>%
  mutate(Sender4 = countrycode(sender4, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU", "1001" = "EEC", "678" = "YEM"))) %>%
  mutate(Sender5 = countrycode(sender5, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU", "1001"= "EEC"))) %>%
  mutate(Primarysender = countrycode(primarysender, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU", "1001" = "EEC"))) %>%
  mutate(Target1 = countrycode(targetstate, origin = "cown", destination = "iso3c",
                               custom_match = c("260" = "DEU", "265" = "DDR", "315" = "CZE", "345" = "YUG", "1000" = "EU",  "680" = "YPR", "817" = "RVN", "1001" = "EEC")))   

TIES <- TIES %>%
  select(-c(sender1, sender2, sender3, sender4, sender5, primarysender, targetstate))

```

## Rewriting U.S.Dollars in US Dollars
```{r}
TIES <- TIES %>%
  mutate(across(where(is.character), ~ str_replace_all(., "U.S. Dollars", "US Dollars"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "U.S. dollars", "US Dollars"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "us dollars", "US Dollars"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "US.Dollars", "US Dollars"))) %>%
  mutate(across(where(is.character), ~ str_replace_all(., "US dollars", "US Dollars")))
```


```{r}
table(TIES$endyear)
```


## Creating event_imposition variable 
```{r}
TIES <- TIES %>%
  mutate(event = make_date(sancimpositionstartyear, sancimpositionstartmonth, 1)) %>%
  mutate(event = format(event, "%m-%Y"))
    
```

## checking for problematic countries
```{r}
table(TIES$Target1)
table(TIES$Sender2)
```



## create binary variables for issue

- using the values of issue1, issue2, issue3 to create binary variables for each variable listed above
```{r}
TIES <- TIES %>%
  mutate(issue_containmilitarybehavior1 = ifelse(issue1 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior2 = ifelse(issue2 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior3 = ifelse(issue3 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior = case_when(
    issue_containmilitarybehavior1 == 1 | issue_containmilitarybehavior2 == 1 |
      issue_containmilitarybehavior3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_containmilitarybehavior1, issue_containmilitarybehavior2, issue_containmilitarybehavior3))

```

#following the same structure for: 
- issue_containpoliticalinfluence (issue1 == 1)
- issue_destabilizeregime (issue1 == 3)
- issue_releasecitizenspropertymaterial (issue1 == 4)
- issue_solveterritorialdispute (issue1 == 5)
- issue_denystrategicmaterials (issue1 == 6)
- issue_retalitateforalliancedalignmentchoice (issue1 == 7)
- issue_improvehumanrights (issue1 == 8)
- issue_endweaponsmaterialproliferation (issue1 == 9)
- issue_terminatesupportnonstateactors (issue1 == 10)
- issue_deterpunishdrugtraffickingpractices (issue1 == 11)
- issue_improveenvironmentalpolicies (issue1 == 12)
- issue_tradepractices (issue1 == 13)
- issue_implementeconomicreform (issue1 == 14)
- issue_other (issue1 == 15)

```{r}
TIES <- TIES %>%
  mutate(issue_containpoliticalinfluence1 = ifelse(issue1 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence2 = ifelse(issue2 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence3 = ifelse(issue3 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence = case_when(
    issue_containpoliticalinfluence1 == 1 | issue_containpoliticalinfluence2 == 1 |
      issue_containpoliticalinfluence3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_containpoliticalinfluence1, issue_containpoliticalinfluence2, issue_containpoliticalinfluence3))

TIES <- TIES %>%
  mutate(issue_destabilizeregime1 = ifelse(issue1 == 3, 1, 0)) %>%
  mutate(issue_destabilizeregime2 = ifelse(issue2 == 3, 1, 0)) %>%
  mutate(issue_destabilizeregime3 = ifelse(issue3 == 3, 1, 0)) %>%
  mutate(issue_destabilizeregime = case_when(
    issue_destabilizeregime1 == 1 | issue_destabilizeregime2 == 1 |
      issue_destabilizeregime3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_destabilizeregime1, issue_destabilizeregime2, issue_destabilizeregime3))

TIES <- TIES %>%
  mutate(issue_releasecitizenspropertymaterial1 = ifelse(issue1 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertymaterial2 = ifelse(issue2 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertymaterial3 = ifelse(issue3 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertymaterial = case_when(
    issue_releasecitizenspropertymaterial1 == 1 | issue_releasecitizenspropertymaterial2 == 1 |
      issue_releasecitizenspropertymaterial3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_releasecitizenspropertymaterial1, issue_releasecitizenspropertymaterial2, issue_releasecitizenspropertymaterial3))

TIES <- TIES %>%
  mutate(issue_solveterritorialdispute1 = ifelse(issue1 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute2 = ifelse(issue2 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute3 = ifelse(issue3 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute = case_when(
    issue_solveterritorialdispute1 == 1 | issue_solveterritorialdispute2 == 1 |
      issue_solveterritorialdispute3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_solveterritorialdispute1, issue_solveterritorialdispute2, issue_solveterritorialdispute3))

TIES <- TIES %>%
  mutate(issue_denystrategicmaterials1 = ifelse(issue1 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterials2 = ifelse(issue2 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterials3 = ifelse(issue3 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterials = case_when(
    issue_denystrategicmaterials1 == 1 | issue_denystrategicmaterials2 == 1 |
      issue_denystrategicmaterials3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_denystrategicmaterials1, issue_denystrategicmaterials2, issue_denystrategicmaterials3))

TIES <- TIES %>%
  mutate(issue_retalitateforalliancedalignmentchoice1 = ifelse(issue1 == 7, 1, 0)) %>%
  mutate(issue_retalitateforalliancedalignmentchoice2 = ifelse(issue2 == 7, 1, 0)) %>%
  mutate(issue_retalitateforalliancedalignmentchoice3 = ifelse(issue3 == 7, 1, 0)) %>%
  mutate(issue_retalitateforalliancedalignmentchoice = case_when(
    issue_retalitateforalliancedalignmentchoice1 == 1 | issue_retalitateforalliancedalignmentchoice2 == 1 |
      issue_retalitateforalliancedalignmentchoice3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_retalitateforalliancedalignmentchoice1, issue_retalitateforalliancedalignmentchoice2, issue_retalitateforalliancedalignmentchoice3))

TIES <- TIES %>%
  mutate(issue_improvehumanrights1 = ifelse(issue1 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights2 = ifelse(issue2 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights3 = ifelse(issue3 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights = case_when(
    issue_improvehumanrights1 == 1 | issue_improvehumanrights2 == 1 |
      issue_improvehumanrights3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_improvehumanrights1, issue_improvehumanrights2, issue_improvehumanrights3))

TIES <- TIES %>%
  mutate(issue_endweaponsmaterialproliferation1 = ifelse(issue1 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialproliferation2 = ifelse(issue2 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialproliferation3 = ifelse(issue3 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialproliferation = case_when(
    issue_endweaponsmaterialproliferation1 == 1 | issue_endweaponsmaterialproliferation2 == 1 |
      issue_endweaponsmaterialproliferation3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_endweaponsmaterialproliferation1, issue_endweaponsmaterialproliferation2, issue_endweaponsmaterialproliferation3))

TIES <- TIES %>%
  mutate(issue_terminatesupportnonstateactors1 = ifelse(issue1 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors2 = ifelse(issue2 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors3 = ifelse(issue3 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors = case_when(
    issue_terminatesupportnonstateactors1 == 1 | issue_terminatesupportnonstateactors2 == 1 |
      issue_terminatesupportnonstateactors3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_terminatesupportnonstateactors1, issue_terminatesupportnonstateactors2, issue_terminatesupportnonstateactors3))

TIES <- TIES %>%
  mutate(issue_deterpunishdrugtraffickingpractices1 = ifelse(issue1 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices2 = ifelse(issue2 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices3 = ifelse(issue3 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices = case_when(
    issue_deterpunishdrugtraffickingpractices1 == 1 | issue_deterpunishdrugtraffickingpractices2 == 1 |
      issue_deterpunishdrugtraffickingpractices3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_deterpunishdrugtraffickingpractices1, issue_deterpunishdrugtraffickingpractices2, issue_deterpunishdrugtraffickingpractices3))

TIES <- TIES %>%
  mutate(issue_improveenvironmentalpolicies1 = ifelse(issue1 == 12, 1, 0)) %>%
  mutate(issue_improveenvironmentalpolicies2 = ifelse(issue2 == 12, 1, 0)) %>%
  mutate(issue_improveenvironmentalpolicies3 = ifelse(issue3 == 12, 1, 0)) %>%
  mutate(issue_improveenvironmentalpolicies = case_when(
    issue_improveenvironmentalpolicies1 == 1 | issue_improveenvironmentalpolicies2 == 1 |
      issue_improveenvironmentalpolicies3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_improveenvironmentalpolicies1, issue_improveenvironmentalpolicies2, issue_improveenvironmentalpolicies3))

TIES <- TIES %>%
  mutate(issue_tradepractices1 = ifelse(issue1 == 13, 1, 0)) %>%
  mutate(issue_tradepractices2 = ifelse(issue2 == 13, 1, 0)) %>%
  mutate(issue_tradepractices3 = ifelse(issue3 == 13, 1, 0)) %>%
  mutate(issue_tradepractices = case_when(
    issue_tradepractices1 == 1 | issue_tradepractices2 == 1 |
      issue_tradepractices3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_tradepractices1, issue_tradepractices2, issue_tradepractices3))

TIES <- TIES %>%
  mutate(issue_implementeconomicreform1 = ifelse(issue1 == 14, 1, 0)) %>%
  mutate(issue_implementeconomicreform2 = ifelse(issue2 == 14, 1, 0)) %>%
  mutate(issue_implementeconomicreform3 = ifelse(issue3 == 14, 1, 0)) %>%
  mutate(issue_implementeconomicreform = case_when(
    issue_implementeconomicreform1 == 1 | issue_implementeconomicreform2 == 1 |
      issue_implementeconomicreform3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_implementeconomicreform1, issue_implementeconomicreform2, issue_implementeconomicreform3))

TIES <- TIES %>%
  mutate(issue_other1 = ifelse(issue1 == 15, 1, 0)) %>%
  mutate(issue_other2 = ifelse(issue2 == 15, 1, 0)) %>%
  mutate(issue_other3 = ifelse(issue3 == 15, 1, 0)) %>%
  mutate(issue_other = case_when(
    issue_other1 == 1 | issue_other2 == 1 |
      issue_other3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_other1, issue_other2, issue_other3))

TIES <- TIES %>%
  select(-c(issue1, issue2, issue3))
```


## Creating binary variables for sanctiontype
###Version creating NAs
- splitting up the values of sanctiontype into different binary variables for each sanctiontype
-	Economic_embargo_total == 1
-	Economic_embargo_partial == 2
-	Import_restriction == 3
-	Export_restriction == 4
-	Blockade == 5
-	Asset_freeze == 6
-	Termination_foreignaid == 7
-	Travel_ban == 8
-	Suspension_economic_agreement == 9 
-	Sanction_other == 10




```{r}
table(TIES$economic_embargo_total)
table(TIES$economic_embargo_partial)
table(TIES$import_restriction)
table(TIES$export_restriction)
table(TIES$blockade)
table(TIES$asset_freeze)
table(TIES$termination_foreignaid)
table(TIES$travel_ban)
table(TIES$suspension_economic_agreement)
table(TIES$sanction_other)


```

### Version with 0 instead of NA
```{r}
TIES <- TIES %>%
  separate(sanctiontype, into = c("sanctiontype1", "sanctiontype2", "sanctiontype3", "sanctiontype4", "sanctiontype5", "sanctiontype6", "sanctiontype7", "sanctiontype8"), sep = " ") 

TIES <- TIES %>%
  mutate(economic_embargo_total = coalesce(ifelse(sanctiontype1 == 1 | sanctiontype2 == 1 | sanctiontype3 == 1 | sanctiontype4 == 1 | sanctiontype5 == 1 | sanctiontype6 == 1 | sanctiontype7 == 1 | sanctiontype8 == 1, 1, 0), 0)) %>%
  mutate(economic_embargo_partial = coalesce(ifelse(sanctiontype1 == 2 | sanctiontype2 == 2 | sanctiontype3 == 2 | sanctiontype4 == 2 | sanctiontype5 == 2 | sanctiontype6 == 2 | sanctiontype7 == 2 | sanctiontype8 == 2, 1, 0), 0)) %>%
  mutate(import_restriction = coalesce(ifelse(sanctiontype1 == 3 | sanctiontype2 == 3 | sanctiontype3 == 3 | sanctiontype4 == 3 | sanctiontype5 == 3 | sanctiontype6 == 3 | sanctiontype7 == 3 | sanctiontype8 == 3, 1, 0), 0)) %>%
  mutate(export_restriction = coalesce(ifelse(sanctiontype1 == 4 | sanctiontype2 == 4 | sanctiontype3 == 4 | sanctiontype4 == 4 | sanctiontype5 == 4 | sanctiontype6 == 4 | sanctiontype7 == 4 | sanctiontype8 == 4, 1, 0), 0)) %>%
  mutate(blockade = coalesce(ifelse(sanctiontype1 == 5 | sanctiontype2 == 5 | sanctiontype3 == 5 | sanctiontype4 == 5 | sanctiontype5 == 5 | sanctiontype6 == 5 | sanctiontype7 == 5 | sanctiontype8 == 5, 1, 0), 0)) %>%
  mutate(asset_freeze = coalesce(ifelse(sanctiontype1 == 6 | sanctiontype2 == 6 | sanctiontype3 == 6 | sanctiontype4 == 6 | sanctiontype5 == 6 | sanctiontype6 == 6 | sanctiontype7 == 6 | sanctiontype8 == 6, 1, 0), 0)) %>%
  mutate(termination_foreignaid = coalesce(ifelse(sanctiontype1 == 7 | sanctiontype2 == 7 | sanctiontype3 == 7 | sanctiontype4 == 7 | sanctiontype5 == 7 | sanctiontype6 == 7 | sanctiontype7 == 7 | sanctiontype8 == 7, 1, 0), 0)) %>%
  mutate(travel_ban = coalesce(ifelse(sanctiontype1 == 8 | sanctiontype2 == 8 | sanctiontype3 == 8 | sanctiontype4 == 8 | sanctiontype5 == 8 | sanctiontype6 == 8 | sanctiontype7 == 8 | sanctiontype8 == 8, 1, 0), 0)) %>%
  mutate(suspension_economic_agreement = coalesce(ifelse(sanctiontype1 == 9 | sanctiontype2 == 9 | sanctiontype3 == 9 | sanctiontype4 == 9 | sanctiontype5 == 9 | sanctiontype6 == 9 | sanctiontype7 == 9 | sanctiontype8 == 9, 1, 0), 0)) %>%
  mutate(sanction_other = coalesce(ifelse(sanctiontype1 == 10 | sanctiontype2 == 10 | sanctiontype3 == 10 | sanctiontype4 == 10 | sanctiontype5 == 10 | sanctiontype6 == 10 | sanctiontype7 == 10 | sanctiontype8 == 10, 1, 0), 0)) %>%
  select(-c(sanctiontype1, sanctiontype2, sanctiontype3, sanctiontype4, sanctiontype5, sanctiontype6, sanctiontype7, sanctiontype8))






TIES <- TIES %>%
  mutate(
    economic_embargo_total = ifelse(imposition == 0, NA, economic_embargo_total),
    economic_embargo_partial = ifelse(imposition == 0, NA, economic_embargo_partial),
    import_restriction = ifelse(imposition == 0, NA, import_restriction),
    export_restriction = ifelse(imposition == 0, NA, export_restriction),
    blockade = ifelse(imposition == 0, NA, blockade),
    asset_freeze = ifelse(imposition == 0, NA, asset_freeze),
    termination_foreignaid = ifelse(imposition == 0, NA, termination_foreignaid),
    travel_ban = ifelse(imposition == 0, NA, travel_ban),
    suspension_economic_agreement = ifelse(imposition == 0, NA, suspension_economic_agreement),
    sanction_other = ifelse(imposition == 0, NA, sanction_other)
  )
```



```{r}


TIES <- TIES %>%
  mutate(
    event_day = make_date(sancimpositionstartyear, sancimpositionstartmonth, sancimpositionstartday),
    event_day = format(event_day, "%d-%m-%Y")
  )


```


```{r}
TIES <- subset(TIES, TIES$imposition == 1)
```

• caseid, startday, startmonth, startyear, endmonth, endday, ongoingasofmonth, onngoingsasofday, ongoingasofyear, event, event_imposition
• sancimpositionstartday/month/year
• institution, institutionid, targetinstitution, targetinstitution, otherinstitution
• Sender1, Sender2, Sender3, Sender4, Sender5, Target1, Primarysender
- issue_containpoliticalinfluence
- issue_containmilitarybehavior
- issue_destabilizeregime 
- issue_releasecitizenspropertymaterial 
- issue_solveterritorialdispute 
- issue_denystrategicmaterials 
- issue_retalitateforalliancedalignmentchoice 
- issue_improvehumanrights 
- issue_endweaponsmaterialproliferation 
- issue_terminatesupportnonstateactors 
- issue_deterpunishdrugtraffickingpractices 
- issue_improveenvironmentalpolicies 
- issue_tradepractices
- issue_implementeconomicreform 
- issue_other
• -	Economic_embargo_total 
-	Economic_embargo_partial 
-	Import_restriction 
-	Export_restriction 
-	Blockade 
-	Asset_freeze 
-	Termination_foreignaid 
-	Travel_ban 
-	Suspension_economic_agreement  
-	Sanction_other 
```{r}
TIES_final <- TIES %>%
  select(c(caseid, event, event_day, institution, institutionid, targetinstitution, targetinstitution, otherinstitution, Sender1, Sender2, Sender3, Sender4, Sender5, Target1, Primarysender, issue_containpoliticalinfluence, issue_containmilitarybehavior, issue_destabilizeregime, issue_releasecitizenspropertymaterial, issue_solveterritorialdispute, issue_denystrategicmaterials, issue_retalitateforalliancedalignmentchoice, issue_improvehumanrights, issue_endweaponsmaterialproliferation, issue_terminatesupportnonstateactors, issue_deterpunishdrugtraffickingpractices, issue_improveenvironmentalpolicies, issue_tradepractices, issue_implementeconomicreform, issue_other, economic_embargo_total, economic_embargo_partial, import_restriction, export_restriction, blockade, asset_freeze, termination_foreignaid, travel_ban, suspension_economic_agreement, sanction_other))
```

```{r}
TIES_final <- TIES_final %>%
  mutate(event_full = paste("01", event, sep = "-")) %>%  
  mutate(date = dmy(event_full)) %>%  
  mutate(year = year(date)) %>%  
  select(-c(date, event_full))

```



```{r}
table(TIES_final$Sender1)
TIES_final <- TIES_final %>%
  mutate(Sender1_succ = case_when(
    Sender1 == "DDR" ~ "DEU",
    Sender1 == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Sender1 == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Sender1 == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Sender1 == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Sender1 == "CZE" & year <= 1992 ~ "CZE, SVK",
    Sender1 == "ETH" & year <= 1991 ~ "ETH, ERI",
    Sender1 == "SDN" & year <= 2011 ~ "SDN, SSD",
    TRUE ~ Sender1))
```
```{r}
table(TIES_final$Sender2)
table(TIES_final$Sender3)
table(TIES_final$Sender4)
table(TIES_final$Sender5)
```

```{r}
 TIES_final <- TIES_final %>% 
  mutate(Sender2_succ = case_when(
    Sender2 == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Sender2 == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Sender2 == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Sender2 == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Sender2 == "CZE" & year <= 1992 ~ "CZE, SVK",
    Sender2 == "ETH" & year <= 1991 ~ "ETH, ERI",
    Sender2 == "SDN" & year <= 2011 ~ "SDN, SSD",
    TRUE ~ Sender2))
 
TIES_final <- TIES_final %>%
  mutate(Sender3_succ = case_when(
    Sender3 == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Sender3 == "DDR" ~ "DEU",
    Sender3 == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Sender3 == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Sender3 == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Sender3 == "CZE" & year <= 1992 ~ "CZE, SVK",
    Sender3 == "ETH" & year <= 1991 ~ "ETH, ERI",
    Sender3 == "SDN" & year <= 2011 ~ "SDN, SSD",
    TRUE ~ Sender3))

TIES_final <- TIES_final   %>%
  mutate(Sender4_succ = case_when(
    Sender4 == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Sender4 == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Sender4 == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Sender4 == "DDR" ~ "DEU",
    Sender4 == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Sender4 == "CZE" & year <= 1992 ~ "CZE, SVK",
    Sender4 == "ETH" & year <= 1991 ~ "ETH, ERI",
    Sender4 == "SDN" & year <= 2011 ~ "SDN, SSD",
    TRUE ~ Sender4))
```




```{r}
table(TIES_final$Target1)
TIES_final <- TIES_final %>%
  mutate(Target1_succ = case_when(
    Target1 == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Target1 == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Target1 == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Target1 == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Target1 == "CZE" & year <= 1992 ~ "CZE, SVK",
    Target1 == "ETH" & year <= 1991 ~ "ETH, ERI",
    Target1 == "RVN" & year <= 1975 ~ "VNM",
    Target1 == "SDN" & year <= 2011 ~ "SDN, SSD",
    Target1 == "YPR" ~ "YEM",
    TRUE ~ Target1))
```

```{r}
table(TIES_final$Primarysender)
TIES_final <- TIES_final %>%
  mutate(Primarysender_succ = case_when(
    Primarysender == "YUG" & event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    Primarysender == "YUG" & year == 1991 ~ "BIH, MNE, SRB",
    Primarysender == "YUG" & year <= 2003 & year > 1992 ~ "MNE, SRB",
    Primarysender == "IDN" & year >= 1975 & year <= 2001 ~ "IDN, TLS",
    Primarysender == "CZE" & year <= 1992 ~ "CZE, SVK",
    Primarysender == "ETH" & year <= 1991 ~ "ETH, ERI",
    Primarysender == "RVN" & year <= 1975 ~ "VNM",
    Primarysender == "SDN" & year <= 2011 ~ "SDN, SSD",
    Primarysender == "YPR" ~ "YEM",
    TRUE ~ Primarysender))
 
```

```{r}
TIES_final <- TIES_final %>%
  select(c(event, event_day, year, institution, institutionid, targetinstitution, otherinstitution, Sender1, Sender1_succ, Sender2, Sender2_succ, Sender3, Sender3_succ,  Sender4, Sender4_succ, Sender5, Target1, Target1_succ, Primarysender, Primarysender_succ, issue_containpoliticalinfluence, issue_containmilitarybehavior, issue_destabilizeregime, issue_releasecitizenspropertymaterial, issue_solveterritorialdispute, issue_denystrategicmaterials, issue_retalitateforalliancedalignmentchoice, issue_improvehumanrights, issue_endweaponsmaterialproliferation, issue_terminatesupportnonstateactors, issue_deterpunishdrugtraffickingpractices, issue_improveenvironmentalpolicies, issue_tradepractices, issue_implementeconomicreform, issue_other, economic_embargo_total, economic_embargo_partial, import_restriction, export_restriction, blockade, asset_freeze, termination_foreignaid, travel_ban, suspension_economic_agreement, sanction_other))
```


```{r}
write_csv(TIES_final, "TIES_cleaned.csv")

```



# 9. EUSANCT

```{r}
EUSANCT <- read_excel("EUSANCT_Dataset_Case-level.xls")
```

## Changing from COW to iso3
```{r}
EUSANCT <- EUSANCT %>%
  mutate(targetstate = countrycode(targetstate, origin = "cown", destination = "iso3c", 
                                   custom_match = c("345" = "YUG")))
table(EUSANCT$targetstate)
```


##  changing to iso3-doe for sender1, sender2, sender3, sender4, sender5 
```{r}
EUSANCT <- EUSANCT %>%
  mutate(sender2 = countrycode(sender2, origin = "cown", destination = "iso3c", 
                               custom_match = c("345" = "YUG", "260" = "DEU"))) %>%
  mutate(sender3 = countrycode(sender3, origin = "cown", destination = "iso3c", 
                               custom_match = c("345" = "YUG", "260" = "DEU"))) %>%
  mutate(sender4 = countrycode(sender4, origin = "cown", destination = "iso3c", 
                               custom_match = c("345" = "YUG", "260" = "DEU"))) %>%
  mutate(sender5 = countrycode(sender5, origin = "cown", destination = "iso3c", 
                               custom_match = c("345" = "YUG", "260" = "DEU"))) 
table(EUSANCT$sender5)
```

```{r}
table(EUSANCT$sender4)
table(EUSANCT$sender3)
table(EUSANCT$sender2)

```



## Creating variable startdateUS_event, startdateEU_event, startdateUN_event
forming them into mm-yyyy based on the information in startdateUS, startdateUN, startdateEU which is dd-mm-yyyy

```{r}

EUSANCT <- EUSANCT %>%
  mutate(
    startdateEU = as.Date(startdateEU, format = "%d-%m-%Y"),
    startdateUN = as.Date(startdateUN, format = "%d-%m-%Y"),
    startdateUS = as.Date(startdateUS, format = "%d-%m-%Y")
  )  

EUSANCT <- EUSANCT %>%
  mutate(
    startdateUS_event = ifelse(!is.na(startdateUS), format(startdateUS, "%m-%Y"), NA),
    startdateUN_event = ifelse(!is.na(startdateUN), format(startdateUN, "%m-%Y"), NA),
    startdateEU_event = ifelse(!is.na(startdateEU), format(startdateEU, "%m-%Y"), NA),
    startyearUS_event = ifelse(!is.na(startyearUS), paste("NA", startyearUS, sep="-"), NA),
    startyearUN_event = ifelse(!is.na(startyearUN), paste("NA", startyearUN, sep="-"), NA),
    startyearEU_event = ifelse(!is.na(startyearEU), paste("NA", startyearEU, sep="-"), NA)
  )

print(head(EUSANCT$startdateUS_event))
print(head(EUSANCT$startdateUN_event))
print(head(EUSANCT$startdateEU_event))
print(head(EUSANCT$startyearUS_event))
print(head(EUSANCT$startyearUN_event))
print(head(EUSANCT$startyearEU_event))
  


```


### Creating event variable
```{r}
EUSANCT <- EUSANCT %>%
  mutate(
    startdateEU = as.Date(startdateEU, format = "%d-%m-%Y"),
    startdateUN = as.Date(startdateUN, format = "%d-%m-%Y"),
    startdateUS = as.Date(startdateUS, format = "%d-%m-%Y"),
    startdateEU_event = ifelse(!is.na(startdateEU), format(startdateEU, "%m-%Y"), NA),
    startdateUN_event = ifelse(!is.na(startdateUN), format(startdateUN, "%m-%Y"), NA),
    startdateUS_event = ifelse(!is.na(startdateUS), format(startdateUS, "%m-%Y"), NA),
    startyearEU_event = ifelse(!is.na(startyearEU), as.character(startyearEU), NA),  
    startyearUN_event = ifelse(!is.na(startyearUN), as.character(startyearUN), NA),  
    startyearUS_event = ifelse(!is.na(startyearUS), as.character(startyearUS), NA)   
  )

EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    all_events = list(c(startdateEU_event, startdateUN_event, startdateUS_event, startyearEU_event, startyearUN_event, startyearUS_event))
  ) %>%
  ungroup()

EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    event = {
      non_na_events <- na.omit(unlist(all_events))
      if (length(non_na_events) == 0) {
        NA_character_
      } else {
        minimal_event <- non_na_events[which.min(sapply(non_na_events, function(d) {
          if (grepl("NA", d)) {
            as.Date(paste0(sub("NA-", "", d), "-01"), format="%Y-%m")
          } else {
            as.Date(paste0(substring(d, 4, 7), "-", substring(d, 1, 2), "-01"), format="%Y-%m-%d")
          }
        }))]
        minimal_event[1]
      }
    }
  ) %>%
  ungroup()

print(head(EUSANCT$event))
table(EUSANCT$event, useNA = "ifany")

EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    # Berechne das früheste Jahr nur aus nicht-NA-Werten
    earliest_year = min(c(startyearEU, startyearUN, startyearUS), na.rm = TRUE),
    # Setze event_year, wenn earliest_year vorhanden ist
    event_year = ifelse(is.na(earliest_year), NA_character_, as.character(earliest_year))
  ) %>%
  ungroup()

# Überprüfe das neue DataFrame für event_year
print(head(EUSANCT$event_year))

# Update event basierend auf dem event_year
EUSANCT <- EUSANCT %>%
  mutate(
    event = ifelse(is.na(event), event_year, event)
  )

# Überprüfe das neue DataFrame für event
print(head(EUSANCT$event))
table(EUSANCT$event, useNA = "ifany")


```





```{r}
EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    earliest_year = min(c(startyearEU, startyearUN, startyearUS), na.rm = TRUE),
    event_year = ifelse(is.na(earliest_year), NA_character_, paste("NA", earliest_year, sep = "-"))
  ) %>%
  ungroup()

print(head(EUSANCT$event_year))

EUSANCT <- EUSANCT %>%
  mutate(
    event = ifelse(is.na(event), event_year, event)
  )

print(head(EUSANCT$event))
table(EUSANCT$event, useNA = "ifany")

```

## creating variable event_imposition 
- following same structure as for event_threat, but adapting dat structure ; muss ich gleich hier eingreifen im 

```{r}
print(head(EUSANCT$impositionEU_start))
print(head(EUSANCT$impositionUN_start))
print(head(EUSANCT$impositionUS_start))

str(EUSANCT$impositionEU_start)
str(EUSANCT$impositionUN_start)
str(EUSANCT$impositionUS_start)


EUSANCT <- EUSANCT %>%
  mutate(
    impositionEU_start = parse_date_time(impositionEU_start, orders = c("dmy", "ymd")),
    impositionUN_start = parse_date_time(impositionUN_start, orders = c("dmy", "ymd")),
    impositionUS_start = parse_date_time(impositionUS_start, orders = c("dmy", "ymd")),
    impositionEU_event = ifelse(!is.na(impositionEU_start), format(impositionEU_start, "%m-%Y"), NA),
    impositionUN_event = ifelse(!is.na(impositionUN_start), format(impositionUN_start, "%m-%Y"), NA),
    impositionUS_event = ifelse(!is.na(impositionUS_start), format(impositionUS_start, "%m-%Y"), NA),
    impositionEU_year_event = ifelse(!is.na(impositionEU_year), paste("NA", impositionEU_year, sep = "-"), NA),
    impositionUN_year_event = ifelse(!is.na(impositionUN_year), paste("NA", impositionUN_year, sep = "-"), NA),
    impositionUS_year_event = ifelse(!is.na(impositionUS_year), paste("NA", impositionUS_year, sep = "-"), NA)
  )

print(head(EUSANCT$impositionEU_start))
print(head(EUSANCT$impositionUN_start))
print(head(EUSANCT$impositionUS_start))

str(EUSANCT$impositionEU_start)
str(EUSANCT$impositionUN_start)
str(EUSANCT$impositionUS_start)

invalid_dates <- EUSANCT %>%
  filter(
    is.na(parse_date_time(impositionEU_start, orders = c("dmy", "ymd"))) |
    is.na(parse_date_time(impositionUN_start, orders = c("dmy", "ymd"))) |
    is.na(parse_date_time(impositionUS_start, orders = c("dmy", "ymd")))
  )

print(invalid_dates)

```




## imposition_event
```{r}

EUSANCT <- EUSANCT %>%
  mutate(
    impositionEU_event = ifelse(!is.na(impositionEU_start), format(impositionEU_start, "%m-%Y"), NA),
    impositionUN_event = ifelse(!is.na(impositionUN_start), format(impositionUN_start, "%m-%Y"), NA),
    impositionUS_event = ifelse(!is.na(impositionUS_start), format(impositionUS_start, "%m-%Y"), NA),
    impositionEU_year_event = ifelse(!is.na(impositionEU_year), as.character(impositionEU_year), NA),  
    impositionUN_year_event = ifelse(!is.na(impositionUN_year), as.character(impositionUN_year), NA),  
    impositionUS_year_event = ifelse(!is.na(impositionUS_year), as.character(impositionUS_year), NA)   
  )


EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    all_imposition_events = list(c(impositionEU_event, impositionUN_event, impositionUS_event, impositionEU_year_event, impositionUN_year_event, impositionUS_year_event))
  ) %>%
  ungroup()


EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    imposition_event = {
      non_na_events <- na.omit(unlist(all_imposition_events))
      if (length(non_na_events) == 0) {
        NA_character_
      } else {
        minimal_event <- non_na_events[which.min(sapply(non_na_events, function(d) {
          if (grepl("NA", d)) {
            as.Date(paste0(sub("NA-", "", d), "-01"), format="%Y-%m")
          } else {
            as.Date(paste0(substring(d, 4, 7), "-", substring(d, 1, 2), "-01"), format="%Y-%m-%d")
          }
        }))]
        minimal_event[1]
      }
    }
  ) %>%
  ungroup()


EUSANCT <- EUSANCT %>%
  rowwise() %>%
  mutate(
    earliest_imposition_year = min(c(impositionEU_year, impositionUN_year, impositionUS_year), na.rm = TRUE),
    imposition_event_year = ifelse(is.na(earliest_imposition_year), NA_character_, as.character(earliest_imposition_year))  # Nur das Jahr
  ) %>%
  ungroup()


print(head(EUSANCT$imposition_event_year))


EUSANCT <- EUSANCT %>%
  mutate(
    imposition_event = ifelse(is.na(imposition_event), imposition_event_year, imposition_event)
  )


print(head(EUSANCT$imposition_event))
table(EUSANCT$imposition_event, useNA = "ifany")


EUSANCT <- EUSANCT %>%
  select(-c(impositionEU_event, impositionUN_event, impositionUS_event, impositionEU_year_event, impositionUN_year_event, impositionUS_year_event, earliest_imposition_year, imposition_event_year, all_imposition_events))


EUSANCT <- EUSANCT %>%
  mutate(imposition_event = case_when(
    imposition_event == "NA-Inf" ~ NA_character_,
    TRUE ~ imposition_event
  ))

```


`



```{r}
EUSANCT %>%
  filter(is.na(imposition_event)) %>%
  select(caseid,event, impositionEU, impositionUS, startdateEU, startdateUS, impositionUN, imposition_event)
```



## changing date structure to dd-mm-yyyy in impositionEU_start, impositionUS_start, impositionUN_start, enddateEU, enddateUS, enddateUN
```{r}
EUSANCT <- EUSANCT %>%
  mutate(
    impositionEU_start = as.Date(impositionEU_start, format = "%d%b%Y"),
    impositionUS_start = as.Date(impositionUS_start, format = "%d%b%Y"),
    impositionUN_start = as.Date(impositionUN_start, format = "%d%b%Y"),
    enddateEU = as.Date(enddateEU, format = "%d%b%Y"),
    enddateUS = as.Date(enddateUS, format = "%d%b%Y"),
    enddateUN = as.Date(enddateUN, format = "%d%b%Y")
  )
```

## creating binary variables for issue 
- combining issue1, issue2, and issue3
- issue_containpoliticalinfluence (issue1 == 1)
- issue_containmilitarybehavior (issue1 == 2)
- issue_leadershipchange (issue1 == 3)
- issue_releasecitizenspropertiymaterial (issue1 == 4)
- issue_solveterritorialdispute (issue1 == 5)
- issue_denystrategicmaterial (issue1 == 6)
- issue_retaliateforallianceorallignmentchoice (issue1 == 7)
- issue_improvehumanrights (issue1 == 8)
- issue_endweaponsmaterialsproliferation (issue1 == 9)
- issue_terminatesupportnonstateactors (issue1 == 10)
- issue_deterpunishdrugtraffickingpractices (issue1 == 11)
- issue_violationofconstitutionalorder (issue1 == 12)
- issue_fraudelections (issue1 == 13)
- issue_other (issue1 == 14)

```{r}
EUSANCT <- EUSANCT %>%
  mutate(issue_containpoliticalinfluence1 = ifelse(issue1 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence2 = ifelse(issue2 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence3 = ifelse(issue3 == 1, 1, 0)) %>%
  mutate(issue_containpoliticalinfluence = case_when(
    issue_containpoliticalinfluence1 == 1 | issue_containpoliticalinfluence2 == 1 |
      issue_containpoliticalinfluence3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_containpoliticalinfluence1, issue_containpoliticalinfluence2, issue_containpoliticalinfluence3)) %>%
  mutate(issue_containmilitarybehavior1 = ifelse(issue1 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior2 = ifelse(issue2 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior3 = ifelse(issue3 == 2, 1, 0)) %>%
  mutate(issue_containmilitarybehavior = case_when(
    issue_containmilitarybehavior1 == 1 | issue_containmilitarybehavior2 == 1 |
      issue_containmilitarybehavior3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_containmilitarybehavior1, issue_containmilitarybehavior2, issue_containmilitarybehavior3)) %>%
  mutate(issue_leadershipchange1 = ifelse(issue1 == 3, 1, 0)) %>%
  mutate(issue_leadershipchange2 = ifelse(issue2 == 3, 1, 0)) %>%
  mutate(issue_leadershipchange3 = ifelse(issue3 == 3, 1, 0)) %>%
  mutate(issue_leadershipchange = case_when(
    issue_leadershipchange1 == 1 | issue_leadershipchange2 == 1 |
      issue_leadershipchange3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_leadershipchange1, issue_leadershipchange2, issue_leadershipchange3)) %>%
  mutate(issue_releasecitizenspropertiymaterial1 = ifelse(issue1 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertiymaterial2 = ifelse(issue2 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertiymaterial3 = ifelse(issue3 == 4, 1, 0)) %>%
  mutate(issue_releasecitizenspropertiymaterial = case_when(
    issue_releasecitizenspropertiymaterial1 == 1 | issue_releasecitizenspropertiymaterial2 == 1 |
      issue_releasecitizenspropertiymaterial3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_releasecitizenspropertiymaterial1, issue_releasecitizenspropertiymaterial2, issue_releasecitizenspropertiymaterial3)) %>%
  mutate(issue_solveterritorialdispute1 = ifelse(issue1 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute2 = ifelse(issue2 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute3 = ifelse(issue3 == 5, 1, 0)) %>%
  mutate(issue_solveterritorialdispute = case_when(
    issue_solveterritorialdispute1 == 1 | issue_solveterritorialdispute2 == 1 |
      issue_solveterritorialdispute3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_solveterritorialdispute1, issue_solveterritorialdispute2, issue_solveterritorialdispute3)) %>%
  mutate(issue_denystrategicmaterial1 = ifelse(issue1 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterial2 = ifelse(issue2 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterial3 = ifelse(issue3 == 6, 1, 0)) %>%
  mutate(issue_denystrategicmaterial = case_when(
    issue_denystrategicmaterial1 == 1 | issue_denystrategicmaterial2 == 1 |
      issue_denystrategicmaterial3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_denystrategicmaterial1, issue_denystrategicmaterial2, issue_denystrategicmaterial3)) %>%
  mutate(issue_retaliateforallianceorallignmentchoice1 = ifelse(issue1 == 7, 1, 0)) %>%
  mutate(issue_retaliateforallianceorallignmentchoice2 = ifelse(issue2 == 7, 1, 0)) %>%
  mutate(issue_retaliateforallianceorallignmentchoice3 = ifelse(issue3 == 7, 1, 0)) %>%
  mutate(issue_retaliateforallianceorallignmentchoice = case_when(
    issue_retaliateforallianceorallignmentchoice1 == 1 | issue_retaliateforallianceorallignmentchoice2 == 1 |
      issue_retaliateforallianceorallignmentchoice3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_retaliateforallianceorallignmentchoice1, issue_retaliateforallianceorallignmentchoice2, issue_retaliateforallianceorallignmentchoice3)) %>%
  mutate(issue_improvehumanrights1 = ifelse(issue1 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights2 = ifelse(issue2 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights3 = ifelse(issue3 == 8, 1, 0)) %>%
  mutate(issue_improvehumanrights = case_when(
    issue_improvehumanrights1 == 1 | issue_improvehumanrights2 == 1 |
      issue_improvehumanrights3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_improvehumanrights1, issue_improvehumanrights2, issue_improvehumanrights3)) %>%
  mutate(issue_endweaponsmaterialsproliferation1 = ifelse(issue1 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialsproliferation2 = ifelse(issue2 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialsproliferation3 = ifelse(issue3 == 9, 1, 0)) %>%
  mutate(issue_endweaponsmaterialsproliferation = case_when(
    issue_endweaponsmaterialsproliferation1 == 1 | issue_endweaponsmaterialsproliferation2 == 1 |
      issue_endweaponsmaterialsproliferation3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_endweaponsmaterialsproliferation1, issue_endweaponsmaterialsproliferation2, issue_endweaponsmaterialsproliferation3)) %>%
  mutate(issue_terminatesupportnonstateactors1 = ifelse(issue1 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors2 = ifelse(issue2 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors3 = ifelse(issue3 == 10, 1, 0)) %>%
  mutate(issue_terminatesupportnonstateactors = case_when(
    issue_terminatesupportnonstateactors1 == 1 | issue_terminatesupportnonstateactors2 == 1 |
      issue_terminatesupportnonstateactors3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_terminatesupportnonstateactors1, issue_terminatesupportnonstateactors2, issue_terminatesupportnonstateactors3)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices1 = ifelse(issue1 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices2 = ifelse(issue2 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices3 = ifelse(issue3 == 11, 1, 0)) %>%
  mutate(issue_deterpunishdrugtraffickingpractices = case_when(
    issue_deterpunishdrugtraffickingpractices1 == 1 | issue_deterpunishdrugtraffickingpractices2 == 1 |
      issue_deterpunishdrugtraffickingpractices3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_deterpunishdrugtraffickingpractices1, issue_deterpunishdrugtraffickingpractices2, issue_deterpunishdrugtraffickingpractices3)) %>%
  mutate(issue_violationofconstitutionalorder1 = ifelse(issue1 == 12, 1, 0)) %>%
  mutate(issue_violationofconstitutionalorder2 = ifelse(issue2 == 12, 1, 0)) %>%
  mutate(issue_violationofconstitutionalorder3 = ifelse(issue3 == 12, 1, 0)) %>%
  mutate(issue_violationofconstitutionalorder = case_when(
    issue_violationofconstitutionalorder1 == 1 | issue_violationofconstitutionalorder2 == 1 |
      issue_violationofconstitutionalorder3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_violationofconstitutionalorder1, issue_violationofconstitutionalorder2, issue_violationofconstitutionalorder3)) %>%
  mutate(issue_fraudelections1 = ifelse(issue1 == 13, 1, 0)) %>%
  mutate(issue_fraudelections2 = ifelse(issue2 == 13, 1, 0)) %>%
  mutate(issue_fraudelections3 = ifelse(issue3 == 13, 1, 0)) %>%
  mutate(issue_fraudelections = case_when(
    issue_fraudelections1 == 1 | issue_fraudelections2 == 1 |
      issue_fraudelections3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_fraudelections1, issue_fraudelections2, issue_fraudelections3)) %>%
  mutate(issue_other1 = ifelse(issue1 == 14, 1, 0)) %>%
  mutate(issue_other2 = ifelse(issue2 == 14, 1, 0)) %>%
  mutate(issue_other3 = ifelse(issue3 == 14, 1, 0)) %>%
  mutate(issue_other = case_when(
    issue_other1 == 1 | issue_other2 == 1 |
      issue_other3 == 1 ~ 1,
    TRUE ~ 0)) %>%
  select(-c(issue_other1, issue_other2, issue_other3))

EUSANCT <- EUSANCT %>%
  select(-c(issue1, issue2, issue3))
```


## Creating binary variables for impositionEU_type
- splitting up the values of impositionEU_type into different binary variables for each sanctiontype
-	Economic_embargo_total == 1
-	Economic_embargo_partial == 2
-	Import_restriction == 3
-	Export_restriction == 4
-	Blockade == 5
- Majorfinancialsanction == 6
-	Targetedfinancialsanction_individuals == 7
-	Targetedfinancialsanction_all == 7b
-	Terminationforeignaid == 8 
-	Travelban == 9
- Suspensioneconomicagreement_organisationalexclusion == 10
- diplomaticsanction == 11
- armsembargo == 12
- other_samtion == 13

```{r}

table(EUSANCT$impositionEU_type)
EUSANCT <- EUSANCT %>%
  separate(impositionEU_type, into = c("impositionEU_type1", "impositionEU_type2", "impositionEU_type3", "impositionEU_type4", "impositionEU_type5", "impositionEU_type6", "impositionEU_type7", "impositionEU_type8", "impositionEU_type9", "impositionEU_type10", "impositionEU_type11", "impositionEU_type12"), sep = ";")
```


```{r}
EUSANCT <- EUSANCT %>%
  mutate(
    EU_economic_embargo_total = ifelse(is.na(ifelse(impositionEU_type1 == 1 | impositionEU_type2 == 1 | impositionEU_type3 == 1 | impositionEU_type4 == 1 | impositionEU_type5 == 1 | impositionEU_type6 == 1 | impositionEU_type7 == 1 | impositionEU_type8 == 1 | impositionEU_type9 == 1 | impositionEU_type10 == 1 | impositionEU_type11 == 1 | impositionEU_type12 == 1, 1, 0)), 0, ifelse(impositionEU_type1 == 1 | impositionEU_type2 == 1 | impositionEU_type3 == 1 | impositionEU_type4 == 1 | impositionEU_type5 == 1 | impositionEU_type6 == 1 | impositionEU_type7 == 1 | impositionEU_type8 == 1 | impositionEU_type9 == 1 | impositionEU_type10 == 1 | impositionEU_type11 == 1 | impositionEU_type12 == 1, 1, 0)),
    EU_economic_embargo_partial = ifelse(is.na(ifelse(impositionEU_type1 == 2 | impositionEU_type2 == 2 | impositionEU_type3 == 2 | impositionEU_type4 == 2 | impositionEU_type5 == 2 | impositionEU_type6 == 2 | impositionEU_type7 == 2 | impositionEU_type8 == 2 | impositionEU_type9 == 2 | impositionEU_type10 == 2 | impositionEU_type11 == 2 | impositionEU_type12 == 2, 1, 0)), 0, ifelse(impositionEU_type1 == 2 | impositionEU_type2 == 2 | impositionEU_type3 == 2 | impositionEU_type4 == 2 | impositionEU_type5 == 2 | impositionEU_type6 == 2 | impositionEU_type7 == 2 | impositionEU_type8 == 2 | impositionEU_type9 == 2 | impositionEU_type10 == 2 | impositionEU_type11 == 2 | impositionEU_type12 == 2, 1, 0)),
    EU_import_restriction = ifelse(is.na(ifelse(impositionEU_type1 == 3 | impositionEU_type2 == 3 | impositionEU_type3 == 3 | impositionEU_type4 == 3 | impositionEU_type5 == 3 | impositionEU_type6 == 3 | impositionEU_type7 == 3 | impositionEU_type8 == 3 | impositionEU_type9 == 3 | impositionEU_type10 == 3 | impositionEU_type11 == 3 | impositionEU_type12 == 3, 1, 0)), 0, ifelse(impositionEU_type1 == 3 | impositionEU_type2 == 3 | impositionEU_type3 == 3 | impositionEU_type4 == 3 | impositionEU_type5 == 3 | impositionEU_type6 == 3 | impositionEU_type7 == 3 | impositionEU_type8 == 3 | impositionEU_type9 == 3 | impositionEU_type10 == 3 | impositionEU_type11 == 3 | impositionEU_type12 == 3, 1, 0)),
    EU_export_restriction = ifelse(is.na(ifelse(impositionEU_type1 == 4 | impositionEU_type2 == 4 | impositionEU_type3 == 4 | impositionEU_type4 == 4 | impositionEU_type5 == 4 | impositionEU_type6 == 4 | impositionEU_type7 == 4 | impositionEU_type8 == 4 | impositionEU_type9 == 4 | impositionEU_type10 == 4 | impositionEU_type11 == 4 | impositionEU_type12 == 4, 1, 0)), 0, ifelse(impositionEU_type1 == 4 | impositionEU_type2 == 4 | impositionEU_type3 == 4 | impositionEU_type4 == 4 | impositionEU_type5 == 4 | impositionEU_type6 == 4 | impositionEU_type7 == 4 | impositionEU_type8 == 4 | impositionEU_type9 == 4 | impositionEU_type10 == 4 | impositionEU_type11 == 4 | impositionEU_type12 == 4, 1, 0)),
    EU_blockade = ifelse(is.na(ifelse(impositionEU_type1 == 5 | impositionEU_type2 == 5 | impositionEU_type3 == 5 | impositionEU_type4 == 5 | impositionEU_type5 == 5 | impositionEU_type6 == 5 | impositionEU_type7 == 5 | impositionEU_type8 == 5 | impositionEU_type9 == 5 | impositionEU_type10 == 5 | impositionEU_type11 == 5 | impositionEU_type12 == 5, 1, 0)), 0, ifelse(impositionEU_type1 == 5 | impositionEU_type2 == 5 | impositionEU_type3 == 5 | impositionEU_type4 == 5 | impositionEU_type5 == 5 | impositionEU_type6 == 5 | impositionEU_type7 == 5 | impositionEU_type8 == 5 | impositionEU_type9 == 5 | impositionEU_type10 == 5 | impositionEU_type11 == 5 | impositionEU_type12 == 5, 1, 0)),
    EU_majorfinancialsanction = ifelse(is.na(ifelse(impositionEU_type1 == 6 | impositionEU_type2 == 6 | impositionEU_type3 == 6 | impositionEU_type4 == 6 | impositionEU_type5 == 6 | impositionEU_type6 == 6 | impositionEU_type7 == 6 | impositionEU_type8 == 6 | impositionEU_type9 == 6 | impositionEU_type10 == 6 | impositionEU_type11 == 6 | impositionEU_type12 == 6, 1, 0)), 0, ifelse(impositionEU_type1 == 6 | impositionEU_type2 == 6 | impositionEU_type3 == 6 | impositionEU_type4 == 6 | impositionEU_type5 == 6 | impositionEU_type6 == 6 | impositionEU_type7 == 6 | impositionEU_type8 == 6 | impositionEU_type9 == 6 | impositionEU_type10 == 6 | impositionEU_type11 == 6 | impositionEU_type12 == 6, 1, 0)),
    EU_targetedfinancialsanction_individuals = ifelse(is.na(ifelse(impositionEU_type1 == 7 | impositionEU_type2 == 7 | impositionEU_type3 == 7 | impositionEU_type4 == 7 | impositionEU_type5 == 7 | impositionEU_type6 == 7 | impositionEU_type7 == 7 | impositionEU_type8 == 7 | impositionEU_type9 == 7 | impositionEU_type10 == 7 | impositionEU_type11 == 7 | impositionEU_type12 == 7, 1, 0)), 0, ifelse(impositionEU_type1 == 7 | impositionEU_type2 == 7 | impositionEU_type3 == 7 | impositionEU_type4 == 7 | impositionEU_type5 == 7 | impositionEU_type6 == 7 | impositionEU_type7 == 7 | impositionEU_type8 == 7 | impositionEU_type9 == 7 | impositionEU_type10 == 7 | impositionEU_type11 == 7 | impositionEU_type12 == 7, 1, 0)),
    EU_targetedfinancialsanction_all = ifelse(is.na(ifelse(impositionEU_type1 == "7b" | impositionEU_type2 == "7b" | impositionEU_type3 == "7b" | impositionEU_type4 == "7b" | impositionEU_type5 == "7b" | impositionEU_type6 == "7b" | impositionEU_type7 == "7b" | impositionEU_type8 == "7b" | impositionEU_type9 == "7b" | impositionEU_type10 == "7b" | impositionEU_type11 == "7b" | impositionEU_type12 == "7b", 1, 0)), 0, ifelse(impositionEU_type1 == "7b" | impositionEU_type2 == "7b" | impositionEU_type3 == "7b" | impositionEU_type4 == "7b" | impositionEU_type5 == "7b" | impositionEU_type6 == "7b" | impositionEU_type7 == "7b" | impositionEU_type8 == "7b" | impositionEU_type9 == "7b" | impositionEU_type10 == "7b" | impositionEU_type11 == "7b" | impositionEU_type12 == "7b", 1, 0)),
    EU_terminationforeignaid = ifelse(is.na(ifelse(impositionEU_type1 == 8 | impositionEU_type2 == 8 | impositionEU_type3 == 8 | impositionEU_type4 == 8 | impositionEU_type5 == 8 | impositionEU_type6 == 8 | impositionEU_type7 == 8 | impositionEU_type8 == 8 | impositionEU_type9 == 8 | impositionEU_type10 == 8 | impositionEU_type11 == 8 | impositionEU_type12 == 8, 1, 0)), 0, ifelse(impositionEU_type1 == 8 | impositionEU_type2 == 8 | impositionEU_type3 == 8 | impositionEU_type4 == 8 | impositionEU_type5 == 8 | impositionEU_type6 == 8 | impositionEU_type7 == 8 | impositionEU_type8 == 8 | impositionEU_type9 == 8 | impositionEU_type10 == 8 | impositionEU_type11 == 8 | impositionEU_type12 == 8, 1, 0)),
    EU_travelban = ifelse(is.na(ifelse(impositionEU_type1 == 9 | impositionEU_type2 == 9 | impositionEU_type3 == 9 | impositionEU_type4 == 9 | impositionEU_type5 == 9 | impositionEU_type6 == 9 | impositionEU_type7 == 9 | impositionEU_type8 == 9 | impositionEU_type9 == 9 | impositionEU_type10 == 9 | impositionEU_type11 == 9 | impositionEU_type12 == 9, 1, 0)), 0, ifelse(impositionEU_type1 == 9 | impositionEU_type2 == 9 | impositionEU_type3 == 9 | impositionEU_type4 == 9 | impositionEU_type5 == 9 | impositionEU_type6 == 9 | impositionEU_type7 == 9 | impositionEU_type8 == 9 | impositionEU_type9 == 9 | impositionEU_type10 == 9 | impositionEU_type11 == 9 | impositionEU_type12 == 9, 1, 0)),
    EU_suspensioneconomicagreement_organisationalexclusion = ifelse(is.na(ifelse(impositionEU_type1 == 10 | impositionEU_type2 == 10 | impositionEU_type3 == 10 | impositionEU_type4 == 10 | impositionEU_type5 == 10 | impositionEU_type6 == 10 | impositionEU_type7 == 10 | impositionEU_type8 == 10 | impositionEU_type9 == 10 | impositionEU_type10 == 10 | impositionEU_type11 == 10 | impositionEU_type12 == 10, 1, 0)), 0, ifelse(impositionEU_type1 == 10 | impositionEU_type2 == 10 | impositionEU_type3 == 10 | impositionEU_type4 == 10 | impositionEU_type5 == 10 | impositionEU_type6 == 10 | impositionEU_type7 == 10 | impositionEU_type8 == 10 | impositionEU_type9 == 10 | impositionEU_type10 == 10 | impositionEU_type11 == 10 | impositionEU_type12 == 10, 1, 0)),
    EU_diplomaticsanction = ifelse(is.na(ifelse(impositionEU_type1 == 11 | impositionEU_type2 == 11 | impositionEU_type3 == 11 | impositionEU_type4 == 11 | impositionEU_type5 == 11 | impositionEU_type6 == 11 | impositionEU_type7 == 11 | impositionEU_type8 == 11 | impositionEU_type9 == 11 | impositionEU_type10 == 11 | impositionEU_type11 == 11 | impositionEU_type12 == 11, 1, 0)), 0, ifelse(impositionEU_type1 == 11 | impositionEU_type2 == 11 | impositionEU_type3 == 11 | impositionEU_type4 == 11 | impositionEU_type5 == 11 | impositionEU_type6 == 11 | impositionEU_type7 == 11 | impositionEU_type8 == 11 | impositionEU_type9 == 11 | impositionEU_type10 == 11 | impositionEU_type11 == 11 | impositionEU_type12 == 11, 1, 0)),
    EU_armsembargo = ifelse(is.na(ifelse(impositionEU_type1 == 12 | impositionEU_type2 == 12 | impositionEU_type3 == 12 | impositionEU_type4 == 12 | impositionEU_type5 == 12 | impositionEU_type6 == 12 | impositionEU_type7 == 12 | impositionEU_type8 == 12 | impositionEU_type9 == 12 | impositionEU_type10 == 12 | impositionEU_type11 == 12 | impositionEU_type12 == 12, 1, 0)), 0, ifelse(impositionEU_type1 == 12 | impositionEU_type2 == 12 | impositionEU_type3 == 12 | impositionEU_type4 == 12 | impositionEU_type5 == 12 | impositionEU_type6 == 12 | impositionEU_type7 == 12 | impositionEU_type8 == 12 | impositionEU_type9 == 12 | impositionEU_type10 == 12 | impositionEU_type11 == 12 | impositionEU_type12 == 12, 1, 0)),
    EU_other_sanction = ifelse(is.na(ifelse(impositionEU_type1 == 13 | impositionEU_type2 == 13 | impositionEU_type3 == 13 | impositionEU_type4 == 13 | impositionEU_type5 == 13 | impositionEU_type6 == 13 | impositionEU_type7 == 13 | impositionEU_type8 == 13 | impositionEU_type9 == 13 | impositionEU_type10 == 13 | impositionEU_type11 == 13 | impositionEU_type12 == 13, 1, 0)), 0, ifelse(impositionEU_type1 == 13 | impositionEU_type2 == 13 | impositionEU_type3 == 13 | impositionEU_type4 == 13 | impositionEU_type5 == 13 | impositionEU_type6 == 13 | impositionEU_type7 == 13 | impositionEU_type8 == 13 | impositionEU_type9 == 13 | impositionEU_type10 == 13 | impositionEU_type11 == 13 | impositionEU_type12 == 13, 1, 0))
  ) %>%
  select(-c(impositionEU_type1, impositionEU_type2, impositionEU_type3, impositionEU_type4, impositionEU_type5, impositionEU_type6, impositionEU_type7, impositionEU_type8, impositionEU_type9, impositionEU_type10, impositionEU_type11, impositionEU_type12))

```

```{r}
table(EUSANCT$impositionUS_type)
```
## creating binary variables for impositionUS_type
- using impositionsUS_type1-13
```{r}
EUSANCT <- EUSANCT %>%
  separate(impositionUS_type, into = c("impositionUS_type1", "impositionUS_type2", "impositionUS_type3", "impositionUS_type4", "impositionUS_type5", "impositionUS_type6", "impositionUS_type7", "impositionUS_type8", "impositionUS_type9", "impositionUS_type10", "impositionUS_type11", "impositionUS_type12", "impositionUS_type13"), sep = ";")

EUSANCT <- EUSANCT %>%
  mutate(
    US_economic_embargo_total = ifelse(is.na(ifelse(impositionUS_type1 == 1 | impositionUS_type2 == 1 | impositionUS_type3 == 1 | impositionUS_type4 == 1 | impositionUS_type5 == 1 | impositionUS_type6 == 1 | impositionUS_type7 == 1 | impositionUS_type8 == 1 | impositionUS_type9 == 1 | impositionUS_type10 == 1 | impositionUS_type11 == 1 | impositionUS_type12 == 1 | impositionUS_type13 == 1, 1, 0)), 0, ifelse(impositionUS_type1 == 1 | impositionUS_type2 == 1 | impositionUS_type3 == 1 | impositionUS_type4 == 1 | impositionUS_type5 == 1 | impositionUS_type6 == 1 | impositionUS_type7 == 1 | impositionUS_type8 == 1 | impositionUS_type9 == 1 | impositionUS_type10 == 1 | impositionUS_type11 == 1 | impositionUS_type12 == 1 | impositionUS_type13 == 1, 1, 0)),
    US_economic_embargo_partial = ifelse(is.na(ifelse(impositionUS_type1 == 2 | impositionUS_type2 == 2 | impositionUS_type3 == 2 | impositionUS_type4 == 2 | impositionUS_type5 == 2 | impositionUS_type6 == 2 | impositionUS_type7 == 2 | impositionUS_type8 == 2 | impositionUS_type9 == 2 | impositionUS_type10 == 2 | impositionUS_type11 == 2 | impositionUS_type12 == 2 | impositionUS_type13 == 2, 1, 0)), 0, ifelse(impositionUS_type1 == 2 | impositionUS_type2 == 2 | impositionUS_type3 == 2 | impositionUS_type4 == 2 | impositionUS_type5 == 2 | impositionUS_type6 == 2 | impositionUS_type7 == 2 | impositionUS_type8 == 2 | impositionUS_type9 == 2 | impositionUS_type10 == 2 | impositionUS_type11 == 2 | impositionUS_type12 == 2 | impositionUS_type13 == 2, 1, 0)),
    US_import_restriction = ifelse(is.na(ifelse(impositionUS_type1 == 3 | impositionUS_type2 == 3 | impositionUS_type3 == 3 | impositionUS_type4 == 3 | impositionUS_type5 == 3 | impositionUS_type6 == 3 | impositionUS_type7 == 3 | impositionUS_type8 == 3 | impositionUS_type9 == 3 | impositionUS_type10 == 3 | impositionUS_type11 == 3 | impositionUS_type12 == 3 | impositionUS_type13 == 3, 1, 0)), 0, ifelse(impositionUS_type1 == 3 | impositionUS_type2 == 3 | impositionUS_type3 == 3 | impositionUS_type4 == 3 | impositionUS_type5 == 3 | impositionUS_type6 == 3 | impositionUS_type7 == 3 | impositionUS_type8 == 3 | impositionUS_type9 == 3 | impositionUS_type10 == 3 | impositionUS_type11 == 3 | impositionUS_type12 == 3 | impositionUS_type13 == 3, 1, 0)),
    US_export_restriction = ifelse(is.na(ifelse(impositionUS_type1 == 4 | impositionUS_type2 == 4 | impositionUS_type3 == 4 | impositionUS_type4 == 4 | impositionUS_type5 == 4 | impositionUS_type6 == 4 | impositionUS_type7 == 4 | impositionUS_type8 == 4 | impositionUS_type9 == 4 | impositionUS_type10 == 4 | impositionUS_type11 == 4 | impositionUS_type12 == 4 | impositionUS_type13 == 4, 1, 0)), 0, ifelse(impositionUS_type1 == 4 | impositionUS_type2 == 4 | impositionUS_type3 == 4 | impositionUS_type4 == 4 | impositionUS_type5 == 4 | impositionUS_type6 == 4 | impositionUS_type7 == 4 | impositionUS_type8 == 4 | impositionUS_type9 == 4 | impositionUS_type10 == 4 | impositionUS_type11 == 4 | impositionUS_type12 == 4 | impositionUS_type13 == 4, 1, 0)),
    US_blockade = ifelse(is.na(ifelse(impositionUS_type1 == 5 | impositionUS_type2 == 5 | impositionUS_type3 == 5 | impositionUS_type4 == 5 | impositionUS_type5 == 5 | impositionUS_type6 == 5 | impositionUS_type7 == 5 | impositionUS_type8 == 5 | impositionUS_type9 == 5 | impositionUS_type10 == 5 | impositionUS_type11 == 5 | impositionUS_type12 == 5 | impositionUS_type13 == 5, 1, 0)), 0, ifelse(impositionUS_type1 == 5 | impositionUS_type2 == 5 | impositionUS_type3 == 5 | impositionUS_type4 == 5 | impositionUS_type5 == 5 | impositionUS_type6 == 5 | impositionUS_type7 == 5 | impositionUS_type8 == 5 | impositionUS_type9 == 5 | impositionUS_type10 == 5 | impositionUS_type11 == 5 | impositionUS_type12 == 5 | impositionUS_type13 == 5, 1, 0)),
    US_majorfinancialsanction = ifelse(is.na(ifelse(impositionUS_type1 == 6 | impositionUS_type2 == 6 | impositionUS_type3 == 6 | impositionUS_type4 == 6 | impositionUS_type5 == 6 | impositionUS_type6 == 6 | impositionUS_type7 == 6 | impositionUS_type8 == 6 | impositionUS_type9 == 6 | impositionUS_type10 == 6 | impositionUS_type11 == 6 | impositionUS_type12 == 6 | impositionUS_type13 == 6, 1, 0)), 0, ifelse(impositionUS_type1 == 6 | impositionUS_type2 == 6 | impositionUS_type3 == 6 | impositionUS_type4 == 6 | impositionUS_type5 == 6 | impositionUS_type6 == 6 | impositionUS_type7 == 6 | impositionUS_type8 == 6 | impositionUS_type9 == 6 | impositionUS_type10 == 6 | impositionUS_type11 == 6 | impositionUS_type12 == 6 | impositionUS_type13 == 6, 1, 0)),
    US_targetedfinancialsanction_individuals = ifelse(is.na(ifelse(impositionUS_type1 == 7 | impositionUS_type2 == 7 | impositionUS_type3 == 7 | impositionUS_type4 == 7 | impositionUS_type5 == 7 | impositionUS_type6 == 7 | impositionUS_type7 == 7 | impositionUS_type8 == 7 | impositionUS_type9 == 7 | impositionUS_type10 == 7 | impositionUS_type11 == 7 | impositionUS_type12 == 7 | impositionUS_type13 == 7, 1, 0)), 0, ifelse(impositionUS_type1 == 7 | impositionUS_type2 == 7 | impositionUS_type3 == 7 | impositionUS_type4 == 7 | impositionUS_type5 == 7 | impositionUS_type6 == 7 | impositionUS_type7 == 7 | impositionUS_type8 == 7 | impositionUS_type9 == 7 | impositionUS_type10 == 7 | impositionUS_type11 == 7 | impositionUS_type12 == 7 | impositionUS_type13 == 7, 1, 0)),
    US_targetedfinancialsanction_all = ifelse(is.na(ifelse(impositionUS_type1 == "7b" | impositionUS_type2 == "7b" | impositionUS_type3 == "7b" | impositionUS_type4 == "7b" | impositionUS_type5 == "7b" | impositionUS_type6 == "7b" | impositionUS_type7 == "7b" | impositionUS_type8 == "7b" | impositionUS_type9 == "7b" | impositionUS_type10 == "7b" | impositionUS_type11 == "7b" | impositionUS_type12 == "7b" | impositionUS_type13 == "7b", 1, 0)), 0, ifelse(impositionUS_type1 == "7b" | impositionUS_type2 == "7b" | impositionUS_type3 == "7b" | impositionUS_type4 == "7b" | impositionUS_type5 == "7b" | impositionUS_type6 == "7b" | impositionUS_type7 == "7b" | impositionUS_type8 == "7b" | impositionUS_type9 == "7b" | impositionUS_type10 == "7b" | impositionUS_type11 == "7b" | impositionUS_type12 == "7b" | impositionUS_type13 == "7b", 1, 0)),
    US_terminationforeignaid = ifelse(is.na(ifelse(impositionUS_type1 == 8 | impositionUS_type2 == 8 | impositionUS_type3 == 8 | impositionUS_type4 == 8 | impositionUS_type5 == 8 | impositionUS_type6 == 8 | impositionUS_type7 == 8 | impositionUS_type8 == 8 | impositionUS_type9 == 8 | impositionUS_type10 == 8 | impositionUS_type11 == 8 | impositionUS_type12 == 8 | impositionUS_type13 == 8, 1, 0)), 0, ifelse(impositionUS_type1 == 8 | impositionUS_type2 == 8 | impositionUS_type3 == 8 | impositionUS_type4 == 8 | impositionUS_type5 == 8 | impositionUS_type6 == 8 | impositionUS_type7 == 8 | impositionUS_type8 == 8 | impositionUS_type9 == 8 | impositionUS_type10 == 8 | impositionUS_type11 == 8 | impositionUS_type12 == 8 | impositionUS_type13 == 8, 1, 0)),
    US_travelban = ifelse(is.na(ifelse(impositionUS_type1 == 9 | impositionUS_type2 == 9 | impositionUS_type3 == 9 | impositionUS_type4 == 9 | impositionUS_type5 == 9 | impositionUS_type6 == 9 | impositionUS_type7 == 9 | impositionUS_type8 == 9 | impositionUS_type9 == 9 | impositionUS_type10 == 9 | impositionUS_type11 == 9 | impositionUS_type12 == 9 | impositionUS_type13 == 9, 1, 0)), 0, ifelse(impositionUS_type1 == 9 | impositionUS_type2 == 9 | impositionUS_type3 == 9 | impositionUS_type4 == 9 | impositionUS_type5 == 9 | impositionUS_type6 == 9 | impositionUS_type7 == 9 | impositionUS_type8 == 9 | impositionUS_type9 == 9 | impositionUS_type10 == 9 | impositionUS_type11 == 9 | impositionUS_type12 == 9 | impositionUS_type13 == 9, 1, 0)),
    US_suspensioneconomicagreement_organisationalexclusion = ifelse(is.na(ifelse(impositionUS_type1 == 10 | impositionUS_type2 == 10 | impositionUS_type3 == 10 | impositionUS_type4 == 10 | impositionUS_type5 == 10 | impositionUS_type6 == 10 | impositionUS_type7 == 10 | impositionUS_type8 == 10 | impositionUS_type9 == 10 | impositionUS_type10 == 10 | impositionUS_type11 == 10 | impositionUS_type12 == 10 | impositionUS_type13 == 10, 1, 0)), 0, ifelse(impositionUS_type1 == 10 | impositionUS_type2 == 10 | impositionUS_type3 == 10 | impositionUS_type4 == 10 | impositionUS_type5 == 10 | impositionUS_type6 == 10 | impositionUS_type7 == 10 | impositionUS_type8 == 10 | impositionUS_type9 == 10 | impositionUS_type10 == 10 | impositionUS_type11 == 10 | impositionUS_type12 == 10 | impositionUS_type13 == 10, 1, 0)),
    US_diplomaticsanction = ifelse(is.na(ifelse(impositionUS_type1 == 11 | impositionUS_type2 == 11 | impositionUS_type3 == 11 | impositionUS_type4 == 11 | impositionUS_type5 == 11 | impositionUS_type6 == 11 | impositionUS_type7 == 11 | impositionUS_type8 == 11 | impositionUS_type9 == 11 | impositionUS_type10 == 11 | impositionUS_type11 == 11 | impositionUS_type12 == 11 | impositionUS_type13 == 11, 1, 0)), 0, ifelse(impositionUS_type1 == 11 | impositionUS_type2 == 11 | impositionUS_type3 == 11 | impositionUS_type4 == 11 | impositionUS_type5 == 11 | impositionUS_type6 == 11 | impositionUS_type7 == 11 | impositionUS_type8 == 11 | impositionUS_type9 == 11 | impositionUS_type10 == 11 | impositionUS_type11 == 11 | impositionUS_type12 == 11 | impositionUS_type13 == 11, 1, 0)),
    US_armsembargo = ifelse(is.na(ifelse(impositionUS_type1 == 12 | impositionUS_type2 == 12 | impositionUS_type3 == 12 | impositionUS_type4 == 12 | impositionUS_type5 == 12 | impositionUS_type6 == 12 | impositionUS_type7 == 12 | impositionUS_type8 == 12 | impositionUS_type9 == 12 | impositionUS_type10 == 12 | impositionUS_type11 == 12 | impositionUS_type12 == 12 | impositionUS_type13 == 12, 1, 0)), 0, ifelse(impositionUS_type1 == 12 | impositionUS_type2 == 12 | impositionUS_type3 == 12 | impositionUS_type4 == 12 | impositionUS_type5 == 12 | impositionUS_type6 == 12 | impositionUS_type7 == 12 | impositionUS_type8 == 12 | impositionUS_type9 == 12 | impositionUS_type10 == 12 | impositionUS_type11 == 12 | impositionUS_type12 == 12 | impositionUS_type13 == 12, 1, 0)),
    US_other_sanction = ifelse(is.na(ifelse(impositionUS_type1 == 13 | impositionUS_type2 == 13 | impositionUS_type3 == 13 | impositionUS_type4 == 13 | impositionUS_type5 == 13 | impositionUS_type6 == 13 | impositionUS_type7 == 13 | impositionUS_type8 == 13 | impositionUS_type9 == 13 | impositionUS_type10 == 13 | impositionUS_type11 == 13 | impositionUS_type12 == 13 | impositionUS_type13 == 13, 1, 0)), 0, ifelse(impositionUS_type1 == 13 | impositionUS_type2 == 13 | impositionUS_type3 == 13 | impositionUS_type4 == 13 | impositionUS_type5 == 13 | impositionUS_type6 == 13 | impositionUS_type7 == 13 | impositionUS_type8 == 13 | impositionUS_type9 == 13 | impositionUS_type10 == 13 | impositionUS_type11 == 13 | impositionUS_type12 == 13 | impositionUS_type13 == 13, 1, 0))
  ) %>%
  select(-c(impositionUS_type1, impositionUS_type2, impositionUS_type3, impositionUS_type4, impositionUS_type5, impositionUS_type6, impositionUS_type7, impositionUS_type8, impositionUS_type9, impositionUS_type10, impositionUS_type11, impositionUS_type12, impositionUS_type13))

# Ausgabe zur Verifizierung
print(head(EUSANCT))

```





## creating binary variables for impositionUN_type
```{r}
table(EUSANCT$impositionUN_type)
```

### based on table results, creating 9 impositionUN_type variables
```{r}
EUSANCT <- EUSANCT %>%
  separate(impositionUN_type, into = c("impositionUN_type1", "impositionUN_type2", "impositionUN_type3", "impositionUN_type4", "impositionUN_type5", "impositionUN_type6", "impositionUN_type7", "impositionUN_type8", "impositionUN_type9"), sep = ";")

EUSANCT <- EUSANCT %>%
  mutate(
    UN_economic_embargo_total = ifelse(is.na(ifelse(impositionUN_type1 == 1 | impositionUN_type2 == 1 | impositionUN_type3 == 1 | impositionUN_type4 == 1 | impositionUN_type5 == 1 | impositionUN_type6 == 1 | impositionUN_type7 == 1 | impositionUN_type8 == 1 | impositionUN_type9 == 1, 1, 0)), 0, ifelse(impositionUN_type1 == 1 | impositionUN_type2 == 1 | impositionUN_type3 == 1 | impositionUN_type4 == 1 | impositionUN_type5 == 1 | impositionUN_type6 == 1 | impositionUN_type7 == 1 | impositionUN_type8 == 1 | impositionUN_type9 == 1, 1, 0)),
    UN_economic_embargo_partial = ifelse(is.na(ifelse(impositionUN_type1 == 2 | impositionUN_type2 == 2 | impositionUN_type3 == 2 | impositionUN_type4 == 2 | impositionUN_type5 == 2 | impositionUN_type6 == 2 | impositionUN_type7 == 2 | impositionUN_type8 == 2 | impositionUN_type9 == 2, 1, 0)), 0, ifelse(impositionUN_type1 == 2 | impositionUN_type2 == 2 | impositionUN_type3 == 2 | impositionUN_type4 == 2 | impositionUN_type5 == 2 | impositionUN_type6 == 2 | impositionUN_type7 == 2 | impositionUN_type8 == 2 | impositionUN_type9 == 2, 1, 0)),
    UN_import_restriction = ifelse(is.na(ifelse(impositionUN_type1 == 3 | impositionUN_type2 == 3 | impositionUN_type3 == 3 | impositionUN_type4 == 3 | impositionUN_type5 == 3 | impositionUN_type6 == 3 | impositionUN_type7 == 3 | impositionUN_type8 == 3 | impositionUN_type9 == 3, 1, 0)), 0, ifelse(impositionUN_type1 == 3 | impositionUN_type2 == 3 | impositionUN_type3 == 3 | impositionUN_type4 == 3 | impositionUN_type5 == 3 | impositionUN_type6 == 3 | impositionUN_type7 == 3 | impositionUN_type8 == 3 | impositionUN_type9 == 3, 1, 0)),
    UN_export_restriction = ifelse(is.na(ifelse(impositionUN_type1 == 4 | impositionUN_type2 == 4 | impositionUN_type3 == 4 | impositionUN_type4 == 4 | impositionUN_type5 == 4 | impositionUN_type6 == 4 | impositionUN_type7 == 4 | impositionUN_type8 == 4 | impositionUN_type9 == 4, 1, 0)), 0, ifelse(impositionUN_type1 == 4 | impositionUN_type2 == 4 | impositionUN_type3 == 4 | impositionUN_type4 == 4 | impositionUN_type5 == 4 | impositionUN_type6 == 4 | impositionUN_type7 == 4 | impositionUN_type8 == 4 | impositionUN_type9 == 4, 1, 0)),
    UN_blockade = ifelse(is.na(ifelse(impositionUN_type1 == 5 | impositionUN_type2 == 5 | impositionUN_type3 == 5 | impositionUN_type4 == 5 | impositionUN_type5 == 5 | impositionUN_type6 == 5 | impositionUN_type7 == 5 | impositionUN_type8 == 5 | impositionUN_type9 == 5, 1, 0)), 0, ifelse(impositionUN_type1 == 5 | impositionUN_type2 == 5 | impositionUN_type3 == 5 | impositionUN_type4 == 5 | impositionUN_type5 == 5 | impositionUN_type6 == 5 | impositionUN_type7 == 5 | impositionUN_type8 == 5 | impositionUN_type9 == 5, 1, 0)),
    UN_majorfinancialsanction = ifelse(is.na(ifelse(impositionUN_type1 == 6 | impositionUN_type2 == 6 | impositionUN_type3 == 6 | impositionUN_type4 == 6 | impositionUN_type5 == 6 | impositionUN_type6 == 6 | impositionUN_type7 == 6 | impositionUN_type8 == 6 | impositionUN_type9 == 6, 1, 0)), 0, ifelse(impositionUN_type1 == 6 | impositionUN_type2 == 6 | impositionUN_type3 == 6 | impositionUN_type4 == 6 | impositionUN_type5 == 6 | impositionUN_type6 == 6 | impositionUN_type7 == 6 | impositionUN_type8 == 6 | impositionUN_type9 == 6, 1, 0)),
    UN_targetedfinancialsanction_individuals = ifelse(is.na(ifelse(impositionUN_type1 == 7 | impositionUN_type2 == 7 | impositionUN_type3 == 7 | impositionUN_type4 == 7 | impositionUN_type5 == 7 | impositionUN_type6 == 7 | impositionUN_type7 == 7 | impositionUN_type8 == 7 | impositionUN_type9 == 7, 1, 0)), 0, ifelse(impositionUN_type1 == 7 | impositionUN_type2 == 7 | impositionUN_type3 == 7 | impositionUN_type4 == 7 | impositionUN_type5 == 7 | impositionUN_type6 == 7 | impositionUN_type7 == 7 | impositionUN_type8 == 7 | impositionUN_type9 == 7, 1, 0)),
    UN_targetedfinancialsanction_all = ifelse(is.na(ifelse(impositionUN_type1 == "7b" | impositionUN_type2 == "7b" | impositionUN_type3 == "7b" | impositionUN_type4 == "7b" | impositionUN_type5 == "7b" | impositionUN_type6 == "7b" | impositionUN_type7 == "7b" | impositionUN_type8 == "7b" | impositionUN_type9 == "7b", 1, 0)), 0, ifelse(impositionUN_type1 == "7b" | impositionUN_type2 == "7b" | impositionUN_type3 == "7b" | impositionUN_type4 == "7b" | impositionUN_type5 == "7b" | impositionUN_type6 == "7b" | impositionUN_type7 == "7b" | impositionUN_type8 == "7b" | impositionUN_type9 == "7b", 1, 0)),
    UN_terminationforeignaid = ifelse(is.na(ifelse(impositionUN_type1 == 8 | impositionUN_type2 == 8 | impositionUN_type3 == 8 | impositionUN_type4 == 8 | impositionUN_type5 == 8 | impositionUN_type6 == 8 | impositionUN_type7 == 8 | impositionUN_type8 == 8 | impositionUN_type9 == 8, 1, 0)), 0, ifelse(impositionUN_type1 == 8 | impositionUN_type2 == 8 | impositionUN_type3 == 8 | impositionUN_type4 == 8 | impositionUN_type5 == 8 | impositionUN_type6 == 8 | impositionUN_type7 == 8 | impositionUN_type8 == 8 | impositionUN_type9 == 8, 1, 0)),
    UN_travelban = ifelse(is.na(ifelse(impositionUN_type1 == 9 | impositionUN_type2 == 9 | impositionUN_type3 == 9 | impositionUN_type4 == 9 | impositionUN_type5 == 9 | impositionUN_type6 == 9 | impositionUN_type7 == 9 | impositionUN_type8 == 9 | impositionUN_type9 == 9, 1, 0)), 0, ifelse(impositionUN_type1 == 9 | impositionUN_type2 == 9 | impositionUN_type3 == 9 | impositionUN_type4 == 9 | impositionUN_type5 == 9 | impositionUN_type6 == 9 | impositionUN_type7 == 9 | impositionUN_type8 == 9 | impositionUN_type9 == 9, 1, 0)),
    UN_suspensioneconomicagreement_organisationalexclusion = ifelse(is.na(ifelse(impositionUN_type1 == 10 | impositionUN_type2 == 10 | impositionUN_type3 == 10 | impositionUN_type4 == 10 | impositionUN_type5 == 10 | impositionUN_type6 == 10 | impositionUN_type7 == 10 | impositionUN_type8 == 10 | impositionUN_type9 == 10, 1, 0)), 0, ifelse(impositionUN_type1 == 10 | impositionUN_type2 == 10 | impositionUN_type3 == 10 | impositionUN_type4 == 10 | impositionUN_type5 == 10 | impositionUN_type6 == 10 | impositionUN_type7 == 10 | impositionUN_type8 == 10 | impositionUN_type9 == 10, 1, 0)),
    UN_diplomaticsanction = ifelse(is.na(ifelse(impositionUN_type1 == 11 | impositionUN_type2 == 11 | impositionUN_type3 == 11 | impositionUN_type4 == 11 | impositionUN_type5 == 11 | impositionUN_type6 == 11 | impositionUN_type7 == 11 | impositionUN_type8 == 11 | impositionUN_type9 == 11, 1, 0)), 0, ifelse(impositionUN_type1 == 11 | impositionUN_type2 == 11 | impositionUN_type3 == 11 | impositionUN_type4 == 11 | impositionUN_type5 == 11 | impositionUN_type6 == 11 | impositionUN_type7 == 11 | impositionUN_type8 == 11 | impositionUN_type9 == 11, 1, 0)),
    UN_armsembargo = ifelse(is.na(ifelse(impositionUN_type1 == 12 | impositionUN_type2 == 12 | impositionUN_type3 == 12 | impositionUN_type4 == 12 | impositionUN_type5 == 12 | impositionUN_type6 == 12 | impositionUN_type7 == 12 | impositionUN_type8 == 12 | impositionUN_type9 == 12, 1, 0)), 0, ifelse(impositionUN_type1 == 12 | impositionUN_type2 == 12 | impositionUN_type3 == 12 | impositionUN_type4 == 12 | impositionUN_type5 == 12 | impositionUN_type6 == 12 | impositionUN_type7 == 12 | impositionUN_type8 == 12 | impositionUN_type9 == 12, 1, 0)),
    UN_other_sanction = ifelse(is.na(ifelse(impositionUN_type1 == 13 | impositionUN_type2 == 13 | impositionUN_type3 == 13 | impositionUN_type4 == 13 | impositionUN_type5 == 13 | impositionUN_type6 == 13 | impositionUN_type7 == 13 | impositionUN_type8 == 13 | impositionUN_type9 == 13, 1, 0)), 0, ifelse(impositionUN_type1 == 13 | impositionUN_type2 == 13 | impositionUN_type3 == 13 | impositionUN_type4 == 13 | impositionUN_type5 == 13 | impositionUN_type6 == 13 | impositionUN_type7 == 13 | impositionUN_type8 == 13 | impositionUN_type9 == 13, 1, 0))
  ) %>%
  select(-c(impositionUN_type1, impositionUN_type2, impositionUN_type3, impositionUN_type4, impositionUN_type5, impositionUN_type6, impositionUN_type7, impositionUN_type8, impositionUN_type9))
```
## Changing 0 to NA in the variables created above, if UNimposition is 0 
```{r}
EUSANCT <- EUSANCT %>%
  mutate(
    UN_economic_embargo_total = ifelse(impositionUN == 0, NA, UN_economic_embargo_total), 
    UN_economic_embargo_partial = ifelse(impositionUN == 0, NA, UN_economic_embargo_partial),
    UN_import_restriction = ifelse(impositionUN == 0, NA, UN_import_restriction),
    UN_export_restriction = ifelse(impositionUN == 0, NA, UN_export_restriction),
    UN_blockade = ifelse(impositionUN == 0, NA, UN_blockade),
    UN_majorfinancialsanction = ifelse(impositionUN == 0, NA, UN_majorfinancialsanction),
    UN_targetedfinancialsanction_individuals = ifelse(impositionUN == 0, NA, UN_targetedfinancialsanction_individuals),
    UN_targetedfinancialsanction_all = ifelse(impositionUN == 0, NA, UN_targetedfinancialsanction_all),
    UN_terminationforeignaid = ifelse(impositionUN == 0, NA, UN_terminationforeignaid),
    UN_travelban = ifelse(impositionUN == 0, NA, UN_travelban),
    UN_suspensioneconomicagreement_organisationalexclusion = ifelse(impositionUN == 0, NA, UN_suspensioneconomicagreement_organisationalexclusion),
    UN_diplomaticsanction = ifelse(impositionUN == 0, NA, UN_diplomaticsanction),
    UN_armsembargo = ifelse(impositionUN == 0, NA, UN_armsembargo),
    UN_other_sanction = ifelse(impositionUN == 0, NA, UN_other_sanction)) %>%
  mutate(
    EU_economic_embargo_total = ifelse(impositionEU == 0, NA, EU_economic_embargo_total),
    EU_economic_embargo_partial = ifelse(impositionEU == 0, NA, EU_economic_embargo_partial),
    EU_import_restriction = ifelse(impositionEU == 0, NA, EU_import_restriction),
    EU_export_restriction = ifelse(impositionEU == 0, NA, EU_export_restriction),
    EU_blockade = ifelse(impositionEU == 0, NA, EU_blockade),
    EU_majorfinancialsanction = ifelse(impositionEU == 0, NA, EU_majorfinancialsanction),
    EU_targetedfinancialsanction_individuals = ifelse(impositionEU == 0, NA, EU_targetedfinancialsanction_individuals),
    EU_targetedfinancialsanction_all = ifelse(impositionEU == 0, NA, EU_targetedfinancialsanction_all),
    EU_terminationforeignaid = ifelse(impositionEU == 0, NA, EU_terminationforeignaid),
    EU_travelban = ifelse(impositionEU == 0, NA, EU_travelban),
    EU_suspensioneconomicagreement_organisationalexclusion = ifelse(impositionEU == 0, NA, EU_suspensioneconomicagreement_organisationalexclusion),
    EU_diplomaticsanction = ifelse(impositionEU == 0, NA, EU_diplomaticsanction),
    EU_armsembargo = ifelse(impositionEU == 0, NA, EU_armsembargo),
    EU_other_sanction = ifelse(impositionEU == 0, NA, EU_other_sanction)) %>%
  mutate(
    US_economic_embargo_total = ifelse(impositionUS == 0, NA, US_economic_embargo_total),
    US_economic_embargo_partial = ifelse(impositionUS == 0, NA, US_economic_embargo_partial),
    US_import_restriction = ifelse(impositionUS == 0, NA, US_import_restriction),
    US_export_restriction = ifelse(impositionUS == 0, NA, US_export_restriction),
    US_blockade = ifelse(impositionUS == 0, NA, US_blockade),
    US_majorfinancialsanction = ifelse(impositionUS == 0, NA, US_majorfinancialsanction),
    US_targetedfinancialsanction_individuals = ifelse(impositionUS == 0, NA, US_targetedfinancialsanction_individuals),
    US_targetedfinancialsanction_all = ifelse(impositionUS == 0, NA, US_targetedfinancialsanction_all),
    US_terminationforeignaid = ifelse(impositionUS == 0, NA, US_terminationforeignaid),
    US_travelban = ifelse(impositionUS == 0, NA, US_travelban),
    US_suspensioneconomicagreement_organisationalexclusion = ifelse(impositionUS == 0, NA, US_suspensioneconomicagreement_organisationalexclusion),
    US_diplomaticsanction = ifelse(impositionUS == 0, NA, US_diplomaticsanction),
    US_armsembargo = ifelse(impositionUS == 0, NA, US_armsembargo),
    US_other_sanction = ifelse(impositionUS == 0, NA, US_other_sanction))
  
    
```





## removing . to NA
```{r}
replace_dot_with_na <- function(x) {
  ifelse(x == ".", NA, x)
}

EUSANCT <- EUSANCT %>%
  mutate(across(where(is.character) | where(is.factor), ~ replace_dot_with_na(.)))

print(head(EUSANCT))

```


## subsetting for cases with threat and imposition (not only threat)
```{r}
EUSANCT_imposition <- subset(EUSANCT, EUSANCT$sanction == 1)
```



```{r}
EUSANCT_imposition <- EUSANCT_imposition %>% 
  mutate(enddateUS = 
           format(enddateUS, "%d-%m-%Y"))

EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(enddateEU = 
           format(enddateEU, "%d-%m-%Y"))

EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(enddateUN = 
           format(enddateUN, "%d-%m-%Y"))
```


```{r}
EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(event_day_EU = 
           format(impositionEU_start, "%d-%m-%Y")) %>%
  mutate(event_EU =
           format(as.Date(event_day_EU, "%d-%m-%Y"), "%m-%Y" ))

EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(event_day_US = 
           format(impositionUS_start, "%d-%m-%Y")) %>%
  mutate(event_US =
           format(as.Date(event_day_US, "%d-%m-%Y"), "%m-%Y" ))

EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(event_day_UN = 
           format(impositionEU_start, "%d-%m-%Y")) %>%
  mutate(event_UN =
           format(as.Date(event_day_UN, "%d-%m-%Y"), "%m-%Y" ))
```


```{r}
names(EUSANCT_imposition)
```

make a select call for only these variables: targetstate EU single_EU US single_US UN single_UN Euprimarysender  enddateUS enddateUN enddateEU sender2 sender3 sender4 sender5 institution2 institution3 targetinstitution3 otherinstitution impositionEU_year event_day_EU event_EU event_day_UN event_UN event_day_US event_US impositionUN_year impositionUS_year impositionEU_year  impositionEU_econ impositionEU_target impositionEU_intensity impositionEU_gradualism   impositionUS_econ impositionUS_target impositionUS_intensity impositionUS_gradualism impositionUN_econ impositionUN_target impositionUN_intensity impositionUNgradualism finaloutcome success policyresult sanctioncontribution HSEscore imposition_event

issue_containpoliticalinfluence"                       
 [99] "issue_containmilitarybehavior"                         
[100] "issue_leadershipchange"                                
[101] "issue_releasecitizenspropertiymaterial"                
[102] "issue_solveterritorialdispute"                         
[103] "issue_denystrategicmaterial"                           
[104] "issue_retaliateforallianceorallignmentchoice"          
[105] "issue_improvehumanrights"                              
[106] "issue_endweaponsmaterialsproliferation"                
[107] "issue_terminatesupportnonstateactors"                  
[108] "issue_deterpunishdrugtraffickingpractices"             
[109] "issue_violationofconstitutionalorder"                  
[110] "issue_fraudelections"                                  
[111] "issue_other"                                           
[112] "EU_economic_embargo_total"                             
[113] "EU_economic_embargo_partial"                           
[114] "EU_import_restriction"                                 
[115] "EU_export_restriction"                                 
[116] "EU_blockade"                                           
[117] "EU_majorfinancialsanction"                             
[118] "EU_targetedfinancialsanction_individuals"              
[119] "EU_targetedfinancialsanction_all"                      
[120] "EU_terminationforeignaid"                              
[121] "EU_travelban"                                          
[122] "EU_suspensioneconomicagreement_organisationalexclusion"
[123] "EU_diplomaticsanction"                                 
[124] "EU_armsembargo"                                        
[125] "EU_other_sanction"                                     
[126] "US_economic_embargo_total"                             
[127] "US_economic_embargo_partial"                           
[128] "US_import_restriction"                                 
[129] "US_export_restriction"                                 
[130] "US_blockade"                                           
[131] "US_majorfinancialsanction"                             
[132] "US_targetedfinancialsanction_individuals"              
[133] "US_targetedfinancialsanction_all"                      
[134] "US_terminationforeignaid"                              
[135] "US_travelban"                                          
[136] "US_suspensioneconomicagreement_organisationalexclusion"
[137] "US_diplomaticsanction"                                 
[138] "US_armsembargo"                                        
[139] "US_other_sanction"                                     
[140] "UN_economic_embargo_total"                             
[141] "UN_economic_embargo_partial"                           
[142] "UN_import_restriction"                                 
[143] "UN_export_restriction"                                 
[144] "UN_blockade"                                           
[145] "UN_majorfinancialsanction"                             
[146] "UN_targetedfinancialsanction_individuals"              
[147] "UN_targetedfinancialsanction_all"                      
[148] "UN_terminationforeignaid"                              
[149] "UN_travelban"                                          
[150] "UN_suspensioneconomicagreement_organisationalexclusion"
[151] "UN_diplomaticsanction"                                 
[152] "UN_armsembargo"                                        
[153] "UN_other_sanction" 
```{r}
EUSANCT_imposition <- EUSANCT_imposition %>%
  select(c(targetstate, EU, single_EU, US, single_US, UN, single_UN, Euprimarysender, enddateUS, enddateUN, enddateEU, sender2, sender3, sender4, sender5, institution2, institution3, targetinstitution3, otherinstitution, impositionEU_year, event_day_EU, event_EU, event_day_UN, event_UN, event_day_US, event_US, impositionUN_year, impositionUS_year, impositionEU_year, impositionEU_econ, impositionEU_target, impositionEU_intensity, impositionEU_gradualism, impositionUS_econ, impositionUS_target, impositionUS_intensity, impositionUS_gradualism, impositionUN_econ, impositionUN_target, impositionUN_intensity, impositionUN_gradualism, finaloutcome, success, policyresult, sanctioncontribution, HSEscore, imposition_event, issue_containpoliticalinfluence, issue_containmilitarybehavior, issue_leadershipchange, issue_releasecitizenspropertiymaterial, issue_solveterritorialdispute, issue_denystrategicmaterial, issue_retaliateforallianceorallignmentchoice, issue_improvehumanrights, issue_endweaponsmaterialsproliferation, issue_terminatesupportnonstateactors, issue_deterpunishdrugtraffickingpractices, issue_violationofconstitutionalorder, issue_fraudelections, issue_other, EU_economic_embargo_total, EU_economic_embargo_partial, EU_import_restriction, EU_export_restriction, EU_blockade, EU_majorfinancialsanction, EU_targetedfinancialsanction_individuals, EU_targetedfinancialsanction_all, EU_terminationforeignaid, EU_travelban, EU_suspensioneconomicagreement_organisationalexclusion, EU_diplomaticsanction, EU_armsembargo, EU_other_sanction, US_economic_embargo_total, US_economic_embargo_partial, US_import_restriction, US_export_restriction, US_blockade, US_majorfinancialsanction, US_targetedfinancialsanction_individuals, US_targetedfinancialsanction_all, US_terminationforeignaid, US_travelban, US_suspensioneconomicagreement_organisationalexclusion, US_diplomaticsanction, US_armsembargo, US_other_sanction, UN_economic_embargo_total, UN_economic_embargo_partial, UN_import_restriction, UN_export_restriction, UN_blockade, UN_majorfinancialsanction, UN_targetedfinancialsanction_individuals, UN_targetedfinancialsanction_all, UN_terminationforeignaid, UN_travelban, UN_suspensioneconomicagreement_organisationalexclusion, UN_diplomaticsanction, UN_armsembargo, UN_other_sanction))
```

```{r}
table(EUSANCT_imposition$targetstate)
EUSANCT_imposition <- EUSANCT_imposition %>%
  mutate(targetstate_succ = case_when(
    targetstate == "YUG" & imposition_event < 1991 ~ "BIH, HRV, MKD, MNE, SRB, SVN",
    targetstate == "YUG" & imposition_event == 1991 ~ "BIH, MNE, SRB",
    targetstate == "YUG" & imposition_event <= 2003 & imposition_event > 1992 ~ "MNE, SRB",
    TRUE ~ targetstate))
```

```{r}
EUSANCT_imposition <- EUSANCT_imposition %>%
  select(c(imposition_event, targetstate, targetstate_succ, EU, single_EU, US, single_US, UN, single_UN, Euprimarysender,  sender2, sender3, sender4, sender5, institution2, institution3, targetinstitution3, otherinstitution, impositionEU_year, event_day_EU, event_EU,  enddateEU,event_day_UN, event_UN,enddateUN, event_day_US, event_US,  enddateUS,impositionUN_year, impositionUS_year, impositionEU_year, impositionEU_econ, impositionEU_target, impositionEU_intensity, impositionEU_gradualism, impositionUS_econ, impositionUS_target, impositionUS_intensity, impositionUS_gradualism, impositionUN_econ, impositionUN_target, impositionUN_intensity, impositionUN_gradualism, finaloutcome, success, policyresult, sanctioncontribution, HSEscore, issue_containpoliticalinfluence, issue_containmilitarybehavior, issue_leadershipchange, issue_releasecitizenspropertiymaterial, issue_solveterritorialdispute, issue_denystrategicmaterial, issue_retaliateforallianceorallignmentchoice, issue_improvehumanrights, issue_endweaponsmaterialsproliferation, issue_terminatesupportnonstateactors, issue_deterpunishdrugtraffickingpractices, issue_violationofconstitutionalorder, issue_fraudelections, issue_other, EU_economic_embargo_total, EU_economic_embargo_partial, EU_import_restriction, EU_export_restriction, EU_blockade, EU_majorfinancialsanction, EU_targetedfinancialsanction_individuals, EU_targetedfinancialsanction_all, EU_terminationforeignaid, EU_travelban, EU_suspensioneconomicagreement_organisationalexclusion, EU_diplomaticsanction, EU_armsembargo, EU_other_sanction, US_economic_embargo_total, US_economic_embargo_partial, US_import_restriction, US_export_restriction, US_blockade, US_majorfinancialsanction, US_targetedfinancialsanction_individuals, US_targetedfinancialsanction_all, US_terminationforeignaid, US_travelban, US_suspensioneconomicagreement_organisationalexclusion, US_diplomaticsanction, US_armsembargo, US_other_sanction, UN_economic_embargo_total, UN_economic_embargo_partial, UN_import_restriction, UN_export_restriction, UN_blockade, UN_majorfinancialsanction, UN_targetedfinancialsanction_individuals, UN_targetedfinancialsanction_all, UN_terminationforeignaid, UN_travelban, UN_suspensioneconomicagreement_organisationalexclusion, UN_diplomaticsanction, UN_armsembargo, UN_other_sanction)) %>%
  mutate(if_else(imposition_event == Inf, NA, imposition_event))
```


```{r}
write.csv(EUSANCT_imposition, "EUSANCT_cleaned.csv")

```


# Nuclear weapons test 

```{r}
weapons_test <- read_csv("number-of-nuclear-weapons-tests.csv", show_col_types = FALSE)
```

```{r}
weapons_test <- weapons_test %>%
  mutate(weapons_test_annualchange = `Number of nuclear weapons tests` - lag(`Number of nuclear weapons tests`, 1))
```


```{r}
weapons_test <- weapons_test %>% 
  slice(rep(1:n(), each = 12)) %>%
  mutate(month = rep(1:12, times = nrow(weapons_test)) %>% factor(levels = 1:12))
```

```{r}
weapons_test <- weapons_test %>%
  mutate(event = make_date(Year, month, 1),
         event = format(event, "%Y-%m"))
    
```

```{r}
table(weapons_test$Code)
```
# Nuclear warheads data 
```{r}
warheads_stockpiles <- read_csv("nuclear-warhead-stockpiles-lines.csv", show_col_types = FALSE)
```

```{r}
warheads_stockpiles <- warheads_stockpiles %>%
  mutate(warheads_annualchange = `Number of nuclear warheads` - lag(`Number of nuclear warheads`, 1))
```


```{r}
warheads_stockpiles <- warheads_stockpiles %>%
  slice(rep(1:n(), each = 12)) %>%
  mutate(month = rep(1:12, times = nrow(warheads_stockpiles)) %>% factor(levels = 1:12))
```

```{r}

warheads_stockpiles <- warheads_stockpiles %>%
  mutate(event = make_date(Year, as.integer(month), 1), 
         event = format(event, "%Y-%m"))
```

```{r}
table(warheads_stockpiles$Code)
table(weapons_test$Code)
warheads_stockpiles <- warheads_stockpiles %>%
  subset(Code != "OWID_WRL")
```

```{r}
Nuclear_proliferation_data <- right_join(weapons_test, warheads_stockpiles, by = c("Code", "event", "Year", "month", "Entity"))
```

```{r}
Nuclear_proliferation_data <- Nuclear_proliferation_data %>%
  select(c(event, Code, Entity, Year, month,  `Number of nuclear weapons tests`, weapons_test_annualchange,`Number of nuclear warheads`, warheads_annualchange ))
```

```{r}
CNS <- read_csv("CNS_trafficking_2023.csv", show_col_types = FALSE)
```



```{r}
test <- read_delim("CNS_trafficking_2023.csv", show_col_types = FALSE, delim = ";")
table(test$Country)

```

```{r}
table(weapons_test$Code)
```
```{r}
write.csv(Nuclear_proliferation_data, "nuclear_proliferation_IAEA.csv")
```
